矩阵分析与应用

第十一讲 矩阵分析及其应用之二

# 信息与通信工程学院 吕旌阳

## 本讲主要内容

- 矩阵函数的一般定义

- 矩阵函数的性质

- 矩阵的微分和积分

## 三、矩阵函数的一般定义

展开式 $f\left( z\right)  = \sum {c}_{k}{z}^{k},\;\left( {\left| z\right|  < r, r > 0}\right)$ ,要求

(1) ${f}^{\left( k\right) }\left( 0\right)$ 存在 $\;\left( {k = 0,1,2,\cdots }\right)$

(2) $\mathop{\lim }\limits_{{k \rightarrow  \infty }}\frac{{f}^{\left( k + 1\right) }\left( \xi \right) }{\left( {k + 1}\right) !}{\xi }^{k + 1} = 0\;\left( {\left| z\right|  < r}\right)$

对于一元函数 $f\left( z\right)  = \frac{1}{z}$ 等,还不能定义矩阵函数。 基于矩阵函数值的Jordan标准形算法, 拓宽定义

矩阵函数的一般定义

设 ${P}^{-1}{AP} = J = \operatorname{diag}\left( {{J}_{1},\cdots ,{J}_{s}}\right) ,{J}_{i} = {\lambda }_{i}I + {I}^{\left( 1\right) }$

如果 $f\left( z\right)$ 在 ${\lambda }_{i}$ 处有 ${m}_{i} - 1$ 阶导数,令

$$
f\left( {J}_{i}\right)  = \mathop{\sum }\limits_{{k = 0}}^{\infty }{c}_{k}{J}_{i}^{k} = f\left( {\lambda }_{i}\right) I + \frac{{f}^{\prime }\left( {\lambda }_{i}\right) }{1!}{I}^{\left( 1\right) } + \cdots  + \frac{{f}^{\left( {m}_{i} - 1\right) }\left( {\lambda }_{i}\right) }{\left( {{m}_{i} - 1}\right) !}{I}^{\left( {m}_{i} - 1\right) }
$$

$$
f\left( A\right)  = \mathop{\sum }\limits_{{k = 0}}^{\infty }{c}_{k}{A}^{k} = P \cdot  \mathop{\sum }\limits_{{k = 0}}^{\infty }{c}_{k}{J}^{k} \cdot  {P}^{-1} = P \cdot  \operatorname{diag}\left( {f\left( {J}_{1}\right) ,\cdots , f\left( {J}_{s}\right) }\right)  \cdot  {P}^{-1}
$$

称 $f\left( A\right)$ 为对应于 $f\left( z\right)$ 的矩阵函数

[注] ① 拓宽定义不要求 $\mathrm{f}\left( \mathrm{z}\right)$ 能展为 “ $\mathrm{z}$ ”的幂级数，但要求在 $\mathrm{A}$ 的特征值 ${\lambda }_{\mathrm{i}}$ (重数为 ${\mathrm{m}}_{\mathrm{i}}$ ) 处有 ${\mathrm{m}}_{\mathrm{i}} - 1$ 阶导数,后者较前者弱!

② 当能够展为 “ $\mathrm{z}$ ”的幂级数时,矩阵函数的拓宽定义与级数原始定义是一致的.

例9: $A = \left\lbrack  \begin{array}{llll} 2 & 1 & & \\   & 2 & 1 & \\   & & 2 & 1 \\   & & & 2 \end{array}\right\rbrack  , f\left( z\right)  = \frac{1}{z}$ ,求 $\;f\left( A\right)$

解: $f\left( z\right)  = \frac{1}{z},{f}^{\prime }\left( z\right)  =  - {z}^{-2},{f}^{\prime \prime }\left( z\right)  = 2{z}^{-3},{f}^{\prime \prime \prime }\left( z\right)  =  - 6{z}^{-4}$

$$
f\left( A\right)  = f\left( J\right)  = f\left( 2\right)  \cdot  I + {f}^{\prime }\left( 2\right)  \cdot  {I}^{\left( 1\right) } + \frac{{f}^{\prime \prime }\left( 2\right) }{2!} \cdot  {I}^{\left( 2\right) } + \frac{{f}^{\prime \prime \prime }\left( 2\right) }{3!} \cdot  {I}^{\left( 3\right) }
$$

$$
= \left\lbrack  \begin{array}{rrrr} {0.5} &  - {0.25} & {0.125} &  - {0.0625} \\   & {0.5} &  - {0.25} & {0.125} \\   & & {0.5} &  - {0.25} \\   & & & {0.5} \end{array}\right\rbrack
$$

例10: $A = \left\lbrack  \begin{array}{lll} 1 & 1 & 0 \\  0 & 1 & 0 \\  0 & 0 & 2 \end{array}\right\rbrack  , f\left( z\right)  = \sqrt{z}$ ,求 $f\left( A\right)$ 解: $f\left( z\right)  = \sqrt{z},{f}^{\prime }\left( z\right)  = \frac{1}{2\sqrt{z}} \; {\mathrm{J}}_{1} = \left\lbrack  \begin{array}{ll} 1 & 1 \\   & 1 \end{array}\right\rbrack   : \;\mathrm{f}\left( {\mathrm{J}}_{1}\right)  = \mathrm{f}\left( 1\right)  \bullet  \mathrm{I} + {\mathrm{f}}^{\prime }\left( 1\right)  \bullet  {\mathrm{I}}^{\left( 1\right) } = \left\lbrack  \begin{array}{rr} 1 & 1/2 \\   & 1 \end{array}\right\rbrack \; {J}_{2} = \left\lbrack  2\right\rbrack   : \;f\left( {J}_{2}\right)  = f\left( 2\right)  \cdot  I = \left\lbrack  \sqrt{2}\right\rbrack$

$$
f\left( A\right)  = f\left( J\right)  = \left\lbrack  \begin{array}{ll} f\left( {J}_{1}\right) & \\   & f\left( {J}_{2}\right)  \end{array}\right\rbrack   = \left\lbrack  \begin{matrix} 1 & 1/2 & 0 \\   & 1 & 0 \\   & & \sqrt{2} \end{matrix}\right\rbrack
$$

## 四、矩阵函数的性质

级数定义或拓宽定义给出的矩阵函数具有下列性质:

(1) $f\left( z\right)  = {f}_{1}\left( z\right)  + {f}_{2}\left( z\right)  \Rightarrow  f\left( A\right)  = {f}_{1}\left( A\right)  + {f}_{2}\left( A\right)$

$$
{f}^{\left( 1\right) }\left( {\lambda }_{i}\right)  = {f}_{1}^{\left( 1\right) }\left( {\lambda }_{i}\right)  + {f}_{2}^{\left( 1\right) }\left( {\lambda }_{i}\right)
$$

$$
\Rightarrow  {\mathrm{f}}^{\left( 1\right) }\left( {\mathrm{J}}_{\mathrm{i}}\right)  = {\mathrm{f}}_{1}^{\left( 1\right) }\left( {\mathrm{J}}_{\mathrm{i}}\right)  + {\mathrm{f}}_{2}^{\left( 1\right) }\left( {\mathrm{J}}_{\mathrm{i}}\right)
$$

$$
f\left( A\right)  = P \cdot  \left\{  {\left\lbrack  \begin{matrix} {f}_{1}\left( {J}_{1}\right) & & \\   &  \ddots  & \\   & & {f}_{1}\left( {J}_{s}\right)  \end{matrix}\right\rbrack   + \left\lbrack  \begin{matrix} {f}_{2}\left( {J}_{1}\right) & & \\   &  \ddots  & \\   & & {f}_{2}\left( {J}_{s}\right)  \end{matrix}\right\rbrack  }\right\}   \cdot  {P}^{-1}
$$

$$
= {f}_{1}\left( A\right)  + {f}_{2}\left( A\right)
$$

$$
\text{ (2) }\;f\left( z\right)  = {f}_{1}\left( z\right)  \cdot  {f}_{2}\left( z\right) \; \Rightarrow  f\left( A\right)  = {f}_{1}\left( A\right)  \cdot  {f}_{2}\left( A\right)  = {f}_{2}\left( A\right)  \cdot  {f}_{1}\left( A\right)
$$

$$
{f}_{1}\left( {J}_{i}\right)  \bullet  {f}_{2}\left( {J}_{i}\right)  = \left\lbrack  {{f}_{1} \bullet  I + {f}_{1}^{\prime } \bullet  {I}^{\left( 1\right) } + \frac{{f}_{1}^{\prime \prime }}{2!} \bullet  {I}^{\left( 2\right) } + \cdots  + \frac{{f}_{1}^{\left( {m}_{i} - 1\right) }}{\left( {{m}_{i} - 1}\right) !} \bullet  {I}^{\left( {m}_{i} - 1\right) }}\right\rbrack   \bullet
$$

$$
\left\lbrack  {{\mathrm{f}}_{2} \cdot  \mathrm{I} + \frac{{\mathrm{f}}_{2}^{\prime }}{1!} \cdot  {\mathrm{I}}^{\left( 1\right) } + \frac{{\mathrm{f}}_{2}^{\prime \prime }}{2!} \cdot  {\mathrm{I}}^{\left( 2\right) } + \cdots  + \frac{{\mathrm{f}}_{2}^{\left( {\mathrm{\;m}}_{\mathrm{i}} - 1\right) }}{\left( {{\mathrm{\;m}}_{\mathrm{i}} - 1}\right) !} \cdot  {\mathrm{I}}^{\left( {\mathrm{m}}_{\mathrm{i}} - 1\right) }}\right\rbrack
$$

$$
= \left( {{\mathrm{f}}_{1}{\mathrm{f}}_{2}}\right)  \cdot  \mathrm{I} + \frac{{\mathrm{f}}_{1}^{\prime }{\mathrm{f}}_{2} + {\mathrm{f}}_{1}{\mathrm{f}}_{2}^{\prime }}{1!} \cdot  {\mathrm{I}}^{\left( 1\right) } + \frac{{\mathrm{f}}_{1}^{\prime \prime }{\mathrm{f}}_{2} + 2{\mathrm{f}}_{1}^{\prime }{\mathrm{f}}_{2}^{\prime } + {\mathrm{f}}_{1}{\mathrm{f}}_{2}^{\prime \prime }}{2!} \cdot  {\mathrm{I}}^{\left( 2\right) } + \cdots
$$

$$
= \left( {{f}_{1}{f}_{2}}\right)  \cdot  I + \frac{{\left( {f}_{1}{f}_{2}\right) }^{\prime }}{1!} \cdot  {I}^{\left( 1\right) } + \frac{{\left( {f}_{1}{f}_{2}\right) }^{\prime \prime }}{2!} \cdot  {I}^{\left( 2\right) } + \cdots  + \frac{{\left( {f}_{1}{f}_{2}\right) }^{\left( {m}_{i} - 1\right) }}{\left( {{m}_{i} - 1}\right) !} \cdot  {I}^{\left( {m}_{i} - 1\right) }
$$

$$
= f\left( {J}_{i}\right)
$$

$$
f\left( A\right)  = P\left\lbrack  {\begin{matrix} f\left( {J}_{1}\right) & & \\   &  \ddots  & \\   & & f\left( {J}_{s}\right)  \end{matrix}{P}^{-1}}\right\rbrack
$$

$$
= P\left\lbrack  \begin{array}{lll} {f}_{1}\left( {J}_{1}\right) & & \\   &  \ddots  & \\   & & {f}_{1}\left( {J}_{s}\right)  \end{array}\right\rbrack  {P}^{-1} \bullet  P\left\lbrack  \begin{array}{lll} {f}_{2}\left( {J}_{1}\right) & & \\   &  \ddots  & \\   & & {f}_{2}\left( {J}_{s}\right)  \end{array}\right\rbrack  {P}^{-1}
$$

$$
= {f}_{1}\left( A\right)  \cdot  {f}_{2}\left( A\right)
$$

## 五、矩阵的微分和积分

定义: 如果矩阵 $A\left( t\right)  = {\left( {a}_{ij}\left( t\right) \right) }_{m \times  n}$ ,的每一个元素 ${a}_{ij}\left( t\right)$ 是变量 $t$ 的可微函数，则 $A\left( t\right)$ 关于 $t$ 的导数(微商)定义为

$$
\frac{\mathrm{{dA}}\left( t\right) }{\mathrm{d}t} = {\left( {a}_{ij}^{\prime }\left( t\right) \right) }_{m \times  n},\;\text{ 或者 }\;{A}^{\prime }\left( t\right)  = {\left( {a}_{ij}^{\prime }\left( t\right) \right) }_{m \times  n}
$$

定理8: 设 $A\left( t\right) , B\left( t\right)$ 可导,则有

(1) $\frac{d}{dt}\left\lbrack  {A\left( t\right)  + B\left( t\right) }\right\rbrack   = \frac{d}{dt}A\left( t\right)  + \frac{d}{dt}B\left( t\right)$ (2) ${A}_{m \times  n}, f\left( t\right)$ 可导 $\frac{d}{dt}\left\lbrack  {f\left( t\right) A\left( t\right) }\right\rbrack   = {f}^{\prime }\left( t\right) A\left( t\right)  + f\left( t\right) {A}^{\prime }\left( t\right)$ (3) ${A}_{m \times  n},{B}_{n \times  l} : \frac{d}{dt}\left\lbrack  {A\left( t\right) B\left( t\right) }\right\rbrack   = {A}^{\prime }\left( t\right) B\left( t\right)  + A\left( t\right) {B}^{\prime }\left( t\right)$ 证明: (3) 左 $= \frac{d}{dt}{\left( \mathop{\sum }\limits_{k}{a}_{ik}\left( t\right) {b}_{kj}\left( t\right) \right) }_{m \times  l} = {\left( \mathop{\sum }\limits_{k}{a}_{ik}^{\prime }\left( t\right) {b}_{kj}\left( t\right)  + \mathop{\sum }\limits_{k}{a}_{ik}\left( t\right) {b}_{kj}^{\prime }\left( t\right) \right) }_{m \times  l}$

$$
= {\left( \mathop{\sum }\limits_{k}{a}_{ik}^{\prime }\left( t\right) {b}_{kj}\left( t\right) \right) }_{m \times  l} + {\left( \mathop{\sum }\limits_{k}{a}_{ik}\left( t\right) {b}_{kj}^{\prime }\left( t\right) \right) }_{m \times  l} = \text{ 右 }
$$

定理9: 设 ${A}_{n \times  n}$ 为常数矩阵,则有

(1) $\;\frac{d}{dt}{e}^{tA} = A{e}^{tA} = {e}^{tA}A$ (2) $\;\frac{d}{dt}\cos \left( {tA}\right)  =  - A \cdot  \sin \left( {tA}\right)  =  - \sin \left( {tA}\right)  \cdot  A$ (3) $\;\frac{d}{dt}\sin \left( {tA}\right)  = A \cdot  \cos \left( {tA}\right)  = \cos \left( {tA}\right)  \cdot  A$ 证明: $\;\left( 1\right) {e}^{tA} = \mathop{\sum }\limits_{{n = 0}}^{\infty }\frac{1}{n!}{\left( tA\right) }^{n}$ 绝对收敛 ${\left( {e}^{tA}\right) }_{ij} = {\delta }_{ij} + \frac{t}{1!}{\left( A\right) }_{ij} + \frac{{t}^{2}}{2!}{\left( {A}^{2}\right) }_{ij} + \cdots  + \frac{{t}^{k}}{k!}{\left( {A}^{k}\right) }_{ij} + \cdots$ 绝对收敛

$$
{\left( {e}^{tA}\right) }_{ij} = {\delta }_{ij} + \frac{t}{1!}{\left( A\right) }_{ij} + \frac{{t}^{2}}{2!}{\left( {A}^{2}\right) }_{ij} + \cdots  + \frac{{t}^{k}}{k!}{\left( {A}^{k}\right) }_{ij} + \cdots \text{ 绝对收敛 }
$$

$$
\frac{\mathrm{d}}{\mathrm{{dt}}}{\left( {\mathrm{e}}^{\mathrm{t}\mathrm{A}}\right) }_{\mathrm{{ij}}} = 0 + {\left( \mathrm{A}\right) }_{\mathrm{{ij}}} + \frac{\mathrm{t}}{1!}{\left( {\mathrm{A}}^{2}\right) }_{\mathrm{{ij}}} + \cdots  + \frac{{\mathrm{t}}^{\mathrm{k} - 1}}{\left( {\mathrm{k} - 1}\right) !}{\left( {\mathrm{A}}^{\mathrm{k}}\right) }_{\mathrm{{ij}}} + \cdots
$$

绝对收敛

$$
\frac{d}{dt}{e}^{tA} = A + \frac{t}{1!}{A}^{2} + \cdots  + \frac{{t}^{k - 1}}{\left( {k - 1}\right) !}{A}^{k} + \cdots
$$

绝对收敛

$$
= \left\{  \begin{array}{ll} A\left\lbrack  {I + \frac{t}{1!}A + \cdots  + \frac{{t}^{k - 1}}{\left( {k - 1}\right) !}{A}^{k - 1} + \cdots }\right\rbrack  &  = A{e}^{tA} \\  \left\lbrack  {I + \frac{t}{1!}A + \cdots  + \frac{{t}^{k - 1}}{\left( {k - 1}\right) !}{A}^{k - 1} + \cdots }\right\rbrack  A &  = {e}^{tA}A \end{array}\right.
$$

例11: $A\left( t\right)  = {\left( {a}_{ij}\left( t\right) \right) }_{n \times  n}$ 可逆,则

$$
\frac{d{A}^{-1}\left( t\right) }{dt} =  - {A}^{-1}\left( t\right) \frac{{dA}\left( t\right) }{dt}{A}^{-1}\left( t\right)
$$

解: 对于恒等式 $\;{A}^{-1}\left( t\right) A\left( t\right)  = I$

两边求导

$$
\frac{{\mathrm{{dA}}}^{-1}\left( \mathrm{t}\right) }{\mathrm{{dt}}}\mathrm{A}\left( \mathrm{t}\right)  + {\mathrm{A}}^{-1}\left( \mathrm{t}\right) \frac{\mathrm{{dA}}\left( \mathrm{t}\right) }{\mathrm{{dt}}} = 0
$$

可得

$$
\frac{{\mathrm{{dA}}}^{-1}\left( \mathrm{t}\right) }{\mathrm{{dt}}} =  - {\mathrm{A}}^{-1}\left( \mathrm{t}\right) \frac{\mathrm{{dA}}\left( \mathrm{t}\right) }{\mathrm{{dt}}}{\mathrm{A}}^{-1}\left( \mathrm{t}\right)
$$

定义: 如果矩阵 $A\left( t\right)  = {\left( {a}_{ij}\left( t\right) \right) }_{m \times  n}$ 的每一个元素 ${a}_{ij}\left( t\right)$ 在 $\left\lbrack  {{t}_{0}, t}\right\rbrack$ 上可积, 称 $A\left( t\right)$ 可积,记为

$$
{\int }_{{t}_{0}}^{t}A\left( \tau \right) {d\tau } = {\left( {\int }_{{t}_{0}}^{t}{a}_{ij}\left( \tau \right) d\tau \right) }_{m \times  n}
$$

(1) ${\int }_{{\mathrm{t}}_{0}}^{\mathrm{t}}\left\lbrack  {\mathrm{\;A}\left( \tau \right)  + \mathrm{B}\left( \tau \right) }\right\rbrack  \mathrm{d}\tau  = {\int }_{{\mathrm{t}}_{0}}^{\mathrm{t}}\mathrm{A}\left( \tau \right) \mathrm{d}\tau  + {\int }_{{\mathrm{t}}_{0}}^{\mathrm{t}}\mathrm{B}\left( \tau \right) \mathrm{d}\tau$

(2)A为常数矩阵: ${\int }_{{t}_{0}}^{t}\left\lbrack  {A \cdot  B\left( \tau \right) }\right\rbrack  {d\tau } = A \cdot  \left\lbrack  {{\int }_{{t}_{0}}^{t}B\left( \tau \right) {d\tau }}\right\rbrack$ B为常数矩阵: ${\int }_{{t}_{0}}^{t}\left\lbrack  {A\left( \tau \right)  \cdot  B}\right\rbrack  {d\tau } = \left\lbrack  {{\int }_{{t}_{0}}^{t}A\left( \tau \right) {d\tau }}\right\rbrack   \cdot  B$ (3)设 ${a}_{ij}\left( t\right)  \in  C\left\lbrack  {{t}_{0},{t}_{1}}\right\rbrack$ 则: $\frac{d}{dt}{\int }_{{t}_{0}}^{t}\bar{A}\left( \tau \right) {d\tau } = \bar{A}\left( t\right)$ (4)设 ${a}_{ij}^{\prime }\left( t\right)  \in  C\left\lbrack  {{t}_{0},{t}_{1}}\right\rbrack$ ，则: ${\int }_{{t}_{0}}^{{t}_{1}}{A}^{\prime }\left( \tau \right) {d\tau } = A\left( {t}_{1}\right)  - A\left( {t}_{0}\right)$

## 其它微分概念

函数对矩阵的导数(包括向量)

定义:设 $X = {\left( {\xi }_{ij}\right) }_{m \times  n}$ , ${mn}$ 元函数

$$
f\left( X\right)  = f\left( {{\xi }_{11},{\xi }_{12},\cdots ,{\xi }_{1\mathrm{n}},\cdots ,{\xi }_{\mathrm{m} \times  \mathrm{n}}}\right)
$$

定义 $f\left( X\right)$ 对矩阵 $X$ 的导数为

$$
\frac{\mathrm{d}f}{\mathrm{d}X} = {\left( \frac{\partial f}{\partial {\xi }_{\text{ ij }}}\right) }_{m \times  n} = \left\lbrack  \begin{matrix} \frac{\partial f}{\partial {\xi }_{11}} & \cdots & \frac{\partial f}{\partial {\xi }_{1\text{ n }}} \\  \vdots & & \vdots \\  \frac{\partial f}{\partial {\xi }_{\text{ m }1}} & \cdots & \frac{\partial f}{\partial {\xi }_{\text{ m }n}} \end{matrix}\right\rbrack
$$

例 12: $x = \left\lbrack  \begin{matrix} {\xi }_{1} \\  \vdots \\  {\xi }_{n} \end{matrix}\right\rbrack   : f\left( x\right)  = f\left( {{\xi }_{1},{\xi }_{2},\cdots ,{\xi }_{n}}\right) \;\frac{df}{dx} = \left\lbrack  \begin{matrix} \frac{\partial f}{\partial {\xi }_{1}} \\  \vdots \\  \frac{\partial f}{\partial {\xi }_{n}} \end{matrix}\right\rbrack$ 例 13: $A = {\left( {a}_{ij}\right) }_{n \times  n}, x = \left\lbrack  \begin{matrix} {\xi }_{1} \\  \vdots \\  {\xi }_{n} \end{matrix}\right\rbrack   : f\left( x\right)  = {x}^{T}{Ax}$ ,求 $\frac{df}{dx} \; f\left( x\right)  = {\xi }_{1}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{1j}{\xi }_{j} + \cdots  + {\xi }_{k}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + \cdots  + {\xi }_{n}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{nj}{\xi }_{j} \; \frac{\partial f}{\partial {\xi }_{k}} = {\xi }_{1}{a}_{1k} + \cdots  + {\xi }_{k - 1}{a}_{k - 1, k} + \left( {\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + {\xi }_{k}{a}_{kk}}\right)  + {\xi }_{k + 1}{a}_{k + 1, k} + \cdots  + {\xi }_{n}{a}_{nk}$

$$
= \mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{ik}{\xi }_{i}
$$

例 13: $A = {\left( {a}_{ij}\right) }_{n \times  n}, x = \left\lbrack  \begin{matrix} {\xi }_{1} \\  \vdots \\  {\xi }_{n} \end{matrix}\right\rbrack   : f\left( x\right)  = {x}^{T}{Ax},$ 求 $\frac{df}{dx} \; f\left( x\right)  = {\xi }_{1}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{1j}{\xi }_{j} + \cdots  + {\xi }_{k}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + \cdots  + {\xi }_{n}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{nj}{\xi }_{j} \; = \mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{ik}{\xi }_{i} = {a}_{ki} + {\xi }_{k + 1}{a}_{k + 1,\mathrm{k}} + {\xi }_{n + 1}{a}_{n + 1,\mathrm{k}} + {\xi }_{k + 1}{a}_{k + 1,\mathrm{k}} + \cdots  + {\xi }_{n}{a}_{nk} \; = \mathop{\sum }\limits_{{j = 1}}^{n}{a}_{kj}{\xi }_{j} + \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{ik}{\xi }_{i} \; \therefore \frac{df}{dx} = \left( {A + {A}^{T}}\right) x$

如果 $A = {A}^{T}$ ,有 $\frac{df}{dx} = {2Ax}$

例 14: $X = {\left( {\xi }_{ij}\right) }_{n \times  n} : f\left( X\right)  = {\left\lbrack  \operatorname{tr}\left( X\right) \right\rbrack  }^{2}$ 求 ${\left. \frac{df}{dX}\right| }_{X = {I}_{n}}$

解: $\;f\left( X\right)  = {\left( {\xi }_{11} + {\xi }_{22} + \cdots  + {\xi }_{nn}\right) }^{2}$

$$
\frac{\mathrm{d}\mathrm{f}}{\mathrm{d}X} = 2\left( {{\xi }_{11} + {\xi }_{22} + \cdots  + {\xi }_{\mathrm{{nn}}}}\right) {\mathrm{I}}_{\mathrm{n}}
$$

$$
{\left. \frac{\mathrm{{df}}}{\mathrm{{dX}}}\right| }_{\mathrm{X} = {\mathrm{I}}_{\mathrm{n}}} = 2\mathrm{n}{\mathrm{I}}_{\mathrm{n}}
$$

例 15: $A \in  {R}^{m \times  n}, b \in  {R}^{m}$ ,若 $x \in  {R}^{n}$ 使得 $\parallel {Ax} - b{\parallel }_{2} = \min$ ,则 ${A}^{T}{Ax} = {A}^{T}b$

解: $f\left( x\right)  = {\begin{Vmatrix}Ax - b\end{Vmatrix}}_{2}^{2} = {\left( Ax - b\right) }^{T}\left( {{Ax} - b}\right)$

$$
= {x}^{T}{A}^{T}{Ax} - 2{b}^{T}{Ax} + {b}^{T}b
$$

$$
g\left( x\right)  = {b}^{T}{Ax} = {b}_{1}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{1j}{\xi }_{j} + \cdots  + {b}_{m}\mathop{\sum }\limits_{{j = 1}}^{n}{a}_{mj}{\xi }_{j}
$$

$$
\frac{dg}{dx} = \left| \begin{matrix} \frac{\partial g}{\partial {\xi }_{1}} \\  \frac{\partial g}{\partial {\xi }_{2}} \end{matrix}\right|  = \left\lbrack  \begin{matrix} {b}_{1}{a}_{11} + \cdots  + {b}_{m}{a}_{m1} \\  {b}_{1}{a}_{1n} + \cdots  + {b}_{m}{a}_{mn} \end{matrix}\right\rbrack   = {A}^{T}b
$$

$$
\frac{\mathrm{d}\mathrm{f}}{\mathrm{d}\mathrm{x}} = 2{\mathrm{\;A}}^{\mathrm{T}}\mathrm{A}\mathrm{x} - 2{\mathrm{\;A}}^{\mathrm{T}}\mathrm{b} = 0 \Rightarrow  {\mathrm{A}}^{\mathrm{T}}\mathrm{A}\mathrm{x} = {\mathrm{A}}^{\mathrm{T}}\mathrm{b}
$$

【注】 $r\left( {{A}^{T}A}\right)  = r\left( A\right) r\left( {{A}^{T}A \mid  {A}^{T}b}\right)  = r\left( {{A}^{T}A}\right)  \Rightarrow  {A}^{T}{Ax} = {A}^{T}b$ 有解

## 5、函数矩阵对矩阵的导数

定义: 设 $X = {\left( {\xi }_{ij}\right) }_{m \times  n},{f}_{kl}\left( X\right)  = {f}_{kl}\left( {{\xi }_{11},{\xi }_{12},\cdots ,{\xi }_{1n},\cdots ,{\xi }_{m \times  n}}\right)$

$$
F = \left\lbrack  \begin{matrix} {f}_{11} & \cdots & {f}_{1s} \\  \vdots & & \vdots \\  {f}_{r1} & \cdots & {f}_{rs} \end{matrix}\right\rbrack
$$

$$
\frac{\partial \mathrm{F}}{\partial {\xi }_{ij}} = \left\lbrack  \begin{matrix} \frac{\partial {\mathrm{f}}_{11}}{\partial {\xi }_{ij}} & \cdots & \frac{\partial {\mathrm{f}}_{1s}}{\partial {\xi }_{ij}} \\  \vdots & & \vdots \\  \frac{\partial {\mathrm{f}}_{r1}}{\partial {\xi }_{ij}} & \cdots & \frac{\partial {\mathrm{f}}_{rs}}{\partial {\xi }_{ij}} \end{matrix}\right\rbrack  ,
$$

定义 $\frac{\mathrm{{dF}}}{\mathrm{{dX}}} = \left\lbrack  \begin{matrix} \frac{\partial F}{\partial {\xi }_{11}} & \cdots & \frac{\partial F}{\partial {\xi }_{1n}} \\  \frac{\partial F}{\partial {\xi }_{m1}} & \cdots & \frac{\partial F}{\partial {\xi }_{mn}} \end{matrix}\right\rbrack$ 可表示为

$$
\frac{\mathrm{{dF}}}{\mathrm{{dX}}} = \left( \frac{1}{\mathrm{{dX}}}\right)  \otimes  \mathrm{{dF}}
$$

$$
\text{ 例16: }x = \left\lbrack  \begin{matrix} {\xi }_{1} \\  \vdots \\  {\xi }_{n} \end{matrix}\right\rbrack  , F\left( x\right)  = \left\lbrack  {{f}_{1}\left( x\right) ,{f}_{2}\left( x\right) ,\cdots ,{f}_{l}\left( x\right) }\right\rbrack  \;\frac{dF}{dx} = \left\lbrack  \begin{matrix} \frac{\partial {f}_{1}}{\partial {\xi }_{1}} & \cdots & \frac{\partial {f}_{l}}{\partial {\xi }_{j}} \\  \vdots & & \vdots \\  \frac{\partial {f}_{1}}{\partial {\xi }_{n}} & \cdots & \frac{\partial {f}_{1}}{\partial {\xi }_{n}} \end{matrix}\right\rbrack
$$

例17: $A = {\left( {a}_{ij}\right) }_{n \times  n}, x = \left\lbrack  \begin{matrix} {\mathbf{\xi }}_{1} \\  \vdots \\  {\mathbf{\xi }}_{n} \end{matrix}\right\rbrack  \;{Ax} = \left\lbrack  \begin{matrix} \mathop{\sum }\limits_{{j = 1}}^{n}{a}_{1j}{\mathbf{\xi }}_{j} \\  \vdots \\  \mathop{\sum }\limits_{{j = 1}}^{n}{a}_{nj}{\mathbf{\xi }}_{j} \end{matrix}\right\rbrack$

$$
\underline{\frac{d\left( {Ax}\right) }{d{x}^{T}} = \left\lbrack  {\frac{d\left( {Ax}\right) }{d{\xi }_{1}}\cdots \frac{d\left( {Ax}\right) }{d{\xi }_{n}}}\right\rbrack  \; = \left\lbrack  \begin{matrix} {a}_{11} & \cdots & {a}_{1n} \\  \vdots & & \vdots \\  {a}_{n1} & \cdots & {a}_{nn} \end{matrix}\right\rbrack   = A}
$$

定理 10 (转换定理) : 设 ${X}_{m \times  n} = \left\lbrack  {x}_{ij}\right\rbrack  ,{Y}_{p \times  q} = \left\lbrack  {y}_{ij}\right\rbrack$ 矩阵 ${A}_{p \times  m},{B}_{n \times  q},{C}_{p \times  n},{D}_{m \times  q}$ 是 $X$ 的函数,则下列两条等价

(1) $\frac{\partial Y}{\partial {x}_{ij}} = A{E}_{ij}B + C{E}_{ij}^{T}D, i = 1,\ldots , m;j = 1,\ldots , n;j = 1,\ldots , n;{E}_{ij} \in  {R}^{m \times  n}$ (2) $\frac{d{y}_{ij}}{dX} = {A}^{T}{E}_{ij}{B}^{T} + D{E}_{ij}^{T}C,\;i = 1,\ldots , p;j = 1,\ldots , q;{E}_{ij} \in  {R}^{p \times  q}$

证明: ${\mathrm{e}}_{\mathrm{i}} = {\left( 0,\ldots ,1,\ldots ,0\right) }^{\mathrm{T}}$ ,则 ${\mathrm{E}}_{\mathrm{{ij}}} = {\mathrm{e}}_{\mathrm{i}}{\mathrm{e}}_{\mathrm{j}}^{\prime }$ ,维数依上下文确定

$$
{\mathrm{e}}_{\mathrm{k}}^{\prime }\left( {{\mathrm{{AE}}}_{\mathrm{{ij}}}\mathrm{B} + {\mathrm{{CE}}}_{\mathrm{{ij}}}^{\mathrm{T}}\mathrm{D}}\right) {\mathrm{e}}_{1}\; = {\mathrm{e}}_{\mathrm{k}}^{\prime }{\mathrm{{Ae}}}_{\mathrm{i}}{\mathrm{e}}_{\mathrm{j}}^{\prime }{\mathrm{{Be}}}_{1} + {\mathrm{e}}_{\mathrm{k}}^{\prime }{\mathrm{{Ce}}}_{\mathrm{j}}{\mathrm{e}}_{\mathrm{i}}^{\prime }{\mathrm{{De}}}_{1}
$$

$$
= {\mathbf{e}}_{\mathrm{i}}^{\prime }{\mathbf{A}}^{\prime }{\mathbf{e}}_{\mathrm{k}}{\mathbf{e}}_{\mathrm{l}}^{\prime }{\mathbf{B}}^{\prime }{\mathbf{e}}_{\mathrm{j}} + {\mathbf{e}}_{\mathrm{i}}^{\prime }\mathbf{D}{\mathbf{e}}_{\mathrm{l}}{\mathbf{e}}_{\mathrm{k}}^{\prime }\mathbf{C}{\mathbf{e}}_{\mathrm{j}}\; = {\mathbf{e}}_{\mathrm{i}}^{\prime }\left( {{\mathbf{A}}^{\prime }{\mathbf{e}}_{\mathrm{k}}{\mathbf{e}}_{\mathrm{l}}^{\prime }{\mathbf{B}}^{\prime } + \mathbf{D}{\mathbf{e}}_{\mathrm{l}}{\mathbf{e}}_{\mathrm{k}}^{\prime }\mathbf{C}}\right) {\mathbf{e}}_{\mathrm{j}}
$$

$$
= {\mathrm{e}}_{\mathrm{i}}^{\prime }\left( {{\mathrm{A}}^{\prime }{\mathrm{E}}_{\mathrm{{kl}}}{\mathrm{B}}^{\prime } + {\mathrm{{DE}}}_{\mathrm{{lk}}}\mathrm{C}}\right) {\mathrm{e}}_{\mathrm{j}}
$$

$$
{\mathrm{e}}_{\mathrm{k}}^{\prime }\left( {{\mathrm{{AE}}}_{\mathrm{{ij}}}\mathrm{B} + {\mathrm{{CE}}}_{\mathrm{{ij}}}^{\mathrm{T}}\mathrm{D}}\right) {\mathrm{e}}_{\mathrm{l}} = {\mathrm{e}}_{\mathrm{i}}^{\prime }\left( {{\mathrm{A}}^{\prime }{\mathrm{E}}_{\mathrm{{kl}}}{\mathrm{B}}^{\prime } + {\mathrm{{DE}}}_{\mathrm{{lk}}}\mathrm{C}}\right) {\mathrm{e}}_{\mathrm{j}}
$$

如果( 1 )成立,则矩阵 $\frac{\partial \mathrm{Y}}{\partial {\mathrm{x}}_{\mathrm{{ij}}}}$ 的 $\left( {\mathrm{k},\mathrm{l}}\right)$ 元

$$
{\left( \frac{\partial \mathrm{Y}}{\partial {\mathrm{x}}_{{}_{\mathrm{{ij}}}}}\right) }_{\mathrm{{kl}}} = {\mathrm{e}}_{\mathrm{k}}^{\prime }\left( {{\mathrm{{AE}}}_{{}_{\mathrm{{ij}}}}\mathrm{B} + {\mathrm{{CE}}}_{{}_{\mathrm{{ij}}}}^{\mathrm{T}}\mathrm{D}}\right) {\mathrm{e}}_{{}_{1}} = {\mathrm{e}}_{\mathrm{i}}^{\prime }\left( {{\mathrm{A}}^{\prime }{\mathrm{E}}_{{}_{\mathrm{{kl}}}}{\mathrm{B}}^{\prime } + {\mathrm{{DE}}}_{{}_{\mathrm{{lk}}}}\mathrm{C}}\right) {\mathrm{e}}_{{}_{\mathrm{j}}}
$$

另外 ${\left( \frac{\partial Y}{\partial {x}_{ij}}\right) }_{kl} = \frac{\partial {y}_{kl}}{\partial {x}_{ij}} = {\left( \frac{\partial {y}_{kl}}{\partial X}\right) }_{ij} = {e}_{i}^{\prime }\left( {{A}^{\prime }{E}_{kl}{B}^{\prime } + D{E}_{lk}C}\right) {e}_{j}$

所以

$$
\frac{\partial {\mathrm{y}}_{\mathrm{{ij}}}}{\partial \mathrm{X}} = {\mathrm{A}}^{\prime }{\mathrm{E}}_{\mathrm{{ij}}}{\mathrm{B}}^{\prime } + {\mathrm{{DE}}}_{\mathrm{{ij}}}^{\prime }\mathrm{C}
$$

例 18: $A \in  {R}^{m \times  n}, X \in  {R}^{n \times  m}$ ,则 $\frac{d\operatorname{tr}\left( {AX}\right) }{dX} = {A}^{T}$

$\frac{\partial Y}{\partial {x}_{ij}} = A{E}_{ij}B + C{E}_{ij}^{T}D$

解: $\frac{\mathrm{d}\operatorname{tr}\left( \mathrm{{AX}}\right) }{\mathrm{d}\mathrm{X}} = \frac{\mathrm{d}}{\mathrm{d}\mathrm{X}}\mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{m}}{\left( \mathrm{{AX}}\right) }_{\mathrm{{ii}}} = \mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{m}}\frac{\partial {\left( \mathrm{{AX}}\right) }_{\mathrm{{ii}}}}{\partial \mathrm{X}}$

$\frac{{\mathrm{{dy}}}_{\mathrm{{ij}}}}{\mathrm{{dX}}} = {\mathrm{A}}^{\mathrm{T}}{\mathrm{E}}_{\mathrm{{ij}}}{\mathrm{B}}^{\mathrm{T}} + {\mathrm{{DE}}}_{\mathrm{{ij}}}^{\mathrm{T}}\mathrm{C}$

因为 $\;\frac{\partial \mathrm{{AX}}}{\partial {\mathrm{X}}_{\mathrm{{ij}}}} = {\mathrm{{AE}}}_{\mathrm{{ij}}},\;{\mathrm{E}}_{\mathrm{{ij}}} \in  {\mathrm{R}}^{\mathrm{n} \times  \mathrm{m}}$

由转换定理 $\frac{\partial {\left( \mathrm{{AX}}\right) }_{\mathrm{{ij}}}}{\partial \mathrm{X}} = {\mathrm{A}}^{\mathrm{T}}{\mathrm{E}}_{\mathrm{{ij}}},\;{\mathrm{E}}_{\mathrm{{ij}}} \in  {\mathrm{R}}^{\mathrm{n} \times  \mathrm{n}}$

$$
\frac{\mathrm{d}\operatorname{tr}\left( {\mathrm{A}\mathrm{X}}\right) }{\mathrm{{dX}}} = \mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{m}}{\mathrm{A}}^{\mathrm{T}}{\mathrm{E}}_{\mathrm{{ii}}} = {\mathrm{A}}^{\mathrm{T}}
$$

【注】 $\mathrm{A} \in  {\mathrm{R}}^{\mathrm{m} \times  \mathrm{n}},\mathrm{x} \in  {\mathrm{R}}^{\mathrm{n}}$ ,则 $\frac{\mathrm{d}\operatorname{tr}\left( {\mathrm{A}\mathrm{x}}\right) }{\mathrm{d}\mathrm{x}} = {\mathrm{A}}^{\mathrm{T}}$

例19: ${A}_{m \times  n},{X}_{n \times  k},{B}_{k \times  m}$ 则 $\frac{d\operatorname{tr}\left( {AXB}\right) }{dX} = {A}^{T}{B}^{T}$ 解: $\frac{\mathrm{d}\operatorname{tr}\left( \mathrm{{AXB}}\right) }{\mathrm{d}\mathrm{X}} = \frac{\mathrm{d}}{\mathrm{d}\mathrm{X}}\mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{m}}{\left( \mathrm{{AXB}}\right) }_{\mathrm{{ii}}} = \mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{m}}\frac{\partial {\left( \mathrm{{AXB}}\right) }_{\mathrm{{ii}}}}{\partial \mathrm{X}} \; \frac{d{y}_{ij}}{dX} = {A}^{T}{E}_{ij}{B}^{T} + D{E}_{ij}^{T}C$ 因为 $\;\frac{\partial \mathrm{{AXB}}}{\partial {\mathrm{x}}_{\mathrm{{ij}}}} = {\mathrm{{AE}}}_{\mathrm{{ij}}}\mathrm{B},\;{\mathrm{E}}_{\mathrm{{ij}}} \in  {\mathrm{R}}^{\mathrm{n} \times  \mathrm{k}} \; \frac{\partial \mathrm{Y}}{\partial {\mathrm{x}}_{\mathrm{i} : }} = {\mathrm{{AE}}}_{\mathrm{{ij}}}\mathrm{B} + {\mathrm{{CE}}}_{\mathrm{{ij}}}^{\mathrm{T}}\mathrm{D}$ 由转换定理 $\frac{\partial {\left( \mathrm{{AXB}}\right) }_{\mathrm{{ij}}}}{\partial \mathrm{X}} = {\mathrm{A}}^{\mathrm{T}}{\mathrm{E}}_{\mathrm{{ij}}}{\mathrm{B}}^{\mathrm{T}},\;{\mathrm{E}}_{\mathrm{{ij}}} \in  {\mathrm{R}}^{\mathrm{m} \times  \mathrm{m}}$

$$
\frac{\mathrm{d}\operatorname{tr}\left( \mathrm{{AXB}}\right) }{\mathrm{{dX}}} = \mathop{\sum }\limits_{{\mathrm{i} = 1}}^{\mathrm{n}}{\mathrm{A}}^{\mathrm{T}}{\mathrm{E}}_{\mathrm{{ii}}}{\mathrm{B}}^{\mathrm{T}} = {\mathrm{A}}^{\mathrm{T}}{\mathrm{B}}^{\mathrm{T}}
$$

例20: (1) ${A}_{nxn},{X}_{nxm}$ 则 $\frac{d\operatorname{tr}\left( {{X}^{T}{AX}}\right) }{dX} = \left( {A + {A}^{T}}\right) X$ (2) ${A}_{m \times  m},{X}_{n \times  m}$ 则 $\frac{d\operatorname{tr}\left( {{XA}{X}^{T}}\right) }{dX} = X\left( {A + {A}^{T}}\right)$ 解: $\;\frac{d\operatorname{tr}\left( {{X}^{\prime }{AX}}\right) }{dX} = \mathop{\sum }\limits_{{i = 1}}^{m}\frac{\partial {\left( {X}^{\prime }AX\right) }_{ii}}{\partial X}$ $\frac{\partial Y}{\partial {x}_{ij}} = A{E}_{ij}B + C{E}_{ij}^{T}D \; \frac{d{y}_{ij}}{dX} = {A}^{T}{E}_{ij}{B}^{T} + D{E}_{ij}^{T}C$ 因为 $\frac{\partial {X}^{\prime }{AX}}{\partial {x}_{ij}} = {E}_{ij}^{\prime }{AX} + {X}^{\prime }A{E}_{ij} = {X}^{\prime }A{E}_{ij}I + I{E}_{ij}^{\prime }{AX}$ 由转换定理 $\frac{\partial {\left( {X}^{\prime }AX\right) }_{ii}}{\partial X} = {A}^{T}X{E}_{ij} + {AX}{E}_{ij}^{T} \; \frac{\mathrm{d}\operatorname{tr}\left( {{X}^{\prime }{AX}}\right) }{\mathrm{d}X} = \mathop{\sum }\limits_{{i = 1}}^{m}\left( {{A}^{T}X{E}_{ii} + {AX}{E}_{ii}^{T}}\right)  = \left( {A + {A}^{T}}\right) X$

矩阵分析的应用

$$
\left\{  \begin{array}{l} {\xi }_{1}^{\prime }\left( t\right)  = {a}_{11}{\xi }_{1}\left( t\right)  + {a}_{12}{\xi }_{2}\left( t\right)  + \cdots  + {a}_{1n}{\xi }_{n}\left( t\right)  + {b}_{1}\left( t\right) \\  {\xi }_{2}^{\prime }\left( t\right)  = {a}_{21}{\xi }_{1}\left( t\right)  + {a}_{22}{\xi }_{2}\left( t\right)  + \cdots  + {a}_{2n}{\xi }_{n}\left( t\right)  + {b}_{2}\left( t\right) \\  \cdots \\  {\xi }_{n}^{\prime }\left( t\right)  = {a}_{n1}{\xi }_{1}\left( t\right)  + {a}_{n2}{\xi }_{2}\left( t\right)  + \cdots  + {a}_{nn}{\xi }_{n}\left( t\right)  + {b}_{n}\left( t\right)  \end{array}\right.
$$

$$
A = \left\lbrack  \begin{matrix} {a}_{11} & \cdots & {a}_{12} \\  \vdots & & \vdots \\  {a}_{n1} & \cdots & {a}_{nn} \end{matrix}\right\rbrack  , X\left( t\right)  = \left\lbrack  \begin{matrix} {\xi }_{1}\left( t\right) \\  \vdots \\  {\xi }_{n}\left( t\right)  \end{matrix}\right\rbrack  , b\left( t\right)  = \left\lbrack  \begin{matrix} {b}_{1}\left( t\right) \\  \vdots \\  {b}_{n}\left( t\right)  \end{matrix}\right\rbrack  , c\left( t\right)  = \left\lbrack  \begin{matrix} {c}_{1}\left( t\right) \\  \vdots \\  {c}_{n}\left( t\right)  \end{matrix}\right\rbrack
$$

齐次微分方程: $\;{x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)$

非齐次微分方程: ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)  + b\left( t\right)$

## 齐次微分方程的解法

定理 10: 齐次方程 ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)$ 满足 $x\left( {t}_{0}\right)  = {x}_{0}$ 的解

存在并且唯一

证: 存在性 设 $x\left( t\right)  = {e}^{\left( {t - {t}_{0}}\right) A}{x}_{0}$ ,则

${x}^{\prime }\left( t\right)  = A{e}^{\left( {t - {t}_{0}}\right) A}{x}_{0} = A \cdot  x\left( t\right) \;x\left( {t}_{0}\right)  = {e}^{O}{x}_{0} = {x}_{0}$

唯一性 设 $x\left( t\right)$ 满足 ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right) , x\left( {t}_{0}\right)  = {x}_{0}$

$$
{x}^{\prime }\left( t\right)  - {Ax}\left( t\right)  = 0 \Rightarrow  {e}^{-{tA}}{x}^{\prime }\left( t\right)  + {e}^{-{tA}}\left( {-A}\right) x\left( t\right)  = 0
$$

$\Rightarrow  {\left\lbrack  {e}^{-{tA}}x\left( t\right) \right\rbrack  }^{\prime } = 0\; \Rightarrow  {e}^{-{tA}}x\left( t\right)  = c \Rightarrow  x\left( t\right)  = {e}^{tA}c$

因为 $x\left( {t}_{0}\right)  = {x}_{0}$ ,所以 ${x}_{0} = {e}^{{t}_{0}A}c \Rightarrow  c = {e}^{-{t}_{0}A}{x}_{0}$

因此 $x\left( t\right)  = {e}^{tA}{e}^{-{t}_{0}A}{x}_{0} = {e}^{\left( {t - {t}_{0}}\right) A}{x}_{0}$

例21: 设 $A = \left\lbrack  \begin{array}{lll} 1 & 1 & 0 \\   & 1 & 0 \\   & & 2 \end{array}\right\rbrack$ 求 ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)$ 的通解

解: $\;{e}^{tA} = \left\lbrack  \begin{array}{rrr} {e}^{t} & t{e}^{t} & 0 \\   & {e}^{t} & 0 \\   & & {e}^{2t} \end{array}\right\rbrack$

$$
x\left( t\right)  = {e}^{tA}c = \left\lbrack  \begin{matrix} {c}_{1}{e}^{t} + {c}_{2}t{e}^{t} \\  {c}_{2}{e}^{t} \\  {c}_{3}{e}^{2t} \end{matrix}\right\rbrack
$$

例 22: 矩阵函数 ${e}^{tA}$ 的列向量 ${x}_{1}\left( t\right) ,\cdots ,{x}_{n}\left( t\right)$ 构成

齐次方程 ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)$ 的基础解系

解: ${\mathrm{e}}^{\mathrm{{tA}}}$ 可逆 $\Rightarrow  {\mathrm{x}}_{1}\left( \mathrm{t}\right) ,\cdots ,{\mathrm{x}}_{\mathrm{n}}\left( \mathrm{t}\right)$ 线性无关

取 $\mathrm{c = {e}_{j} \Rightarrow  {x}_{j}\left( t\right)  = {e}^{tA}c}$ 是 ${x}^{\prime }\left( t\right)  = A \bullet  x\left( t\right)$ 的一个解

通解 $x\left( t\right)  = {e}^{tA}c = {c}_{1} \bullet  {x}_{1}\left( t\right)  + \cdots  + {c}_{n} \bullet  {x}_{n}\left( t\right)$

非齐次微分方程的解法

方程(1): ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)$

方程(2): $\;{x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)  + b\left( t\right)$

$\left. \begin{array}{l} \widetilde{x}\left( t\right) \text{ 是 }\left( 2\right) \text{ 的特解 } \\  x\left( t\right) \text{ 是 }\left( 2\right) \text{ 的通解 } \end{array}\right\}  \;\left\{  \begin{array}{l} {\widetilde{x}}^{\prime }\left( t\right)  = A \bullet  \widetilde{x}\left( t\right)  + b\left( t\right) \\  {x}^{\prime }\left( t\right)  = A \bullet  x\left( t\right)  + b\left( t\right)  \end{array}\right.$

$\Rightarrow  {\left\lbrack  x\left( t\right)  - \widetilde{x}\left( t\right) \right\rbrack  }^{\prime } = A\left\lbrack  {x\left( t\right)  - \widetilde{x}\left( t\right) }\right\rbrack   \Rightarrow  x\left( t\right)  - \widetilde{x}\left( t\right)$ 是(1)的解

$\Rightarrow  x\left( t\right)  - \widetilde{x}\left( t\right)  = {c}_{1} \cdot  {x}_{1}\left( t\right)  + \cdots  + {c}_{n} \cdot  {x}_{n}\left( t\right)$

$\Rightarrow  x\left( t\right)  = {e}^{tA}c + \widetilde{x}\left( t\right)$

## 非齐次微分方程的解法

采用常向量变易法求 $\widetilde{x}\left( t\right)$ . 设 $\widetilde{x}\left( t\right)  = {e}^{tA}c\left( t\right)$ 满足(2),有

$$
{\mathrm{{Ae}}}^{\mathrm{{tA}}}c\left( t\right)  + {\mathrm{e}}^{\mathrm{{tA}}}{c}^{\prime }\left( t\right)  = {\mathrm{{Ae}}}^{\mathrm{{tA}}}c\left( t\right)  + b\left( t\right)
$$

${c}^{\prime }\left( t\right)  = {e}^{-{tA}}b\left( t\right)  \Rightarrow  c\left( t\right)  = {\int }_{{t}_{0}}^{t}{e}^{-{\tau A}}b\left( \tau \right) {d\tau }\;$ (原函数之一)

故 (2) 的通解为 $x\left( t\right)  = {e}^{tA}\left\lbrack  {c + {\int }_{{t}_{0}}^{t}{e}^{-{\tau A}}b\left( \tau \right) {d\tau }}\right\rbrack$

特解为 ${\left. x\left( t\right) \right| }_{x\left( {t}_{0}\right)  = {x}_{0}} = {e}^{tA}\left\lbrack  {{e}^{-{t}_{0}A}{x}_{0} + {\int }_{{t}_{0}}^{t}{e}^{-{\tau A}}b\left( \tau \right) {d\tau }}\right\rbrack$

[注] 当 ${t}_{0} = 0$ 时,特解 ${\left. x\left( t\right) \right| }_{x\left( 0\right)  = {x}_{0}} = {e}^{tA}\left\lbrack  {{x}_{0} + {\int }_{0}^{t}{e}^{-{\tau A}}b\left( \tau \right) {d\tau }}\right\rbrack$

例23: 设 $A = \left\lbrack  \begin{array}{lll} 1 & 1 & 0 \\   & 1 & 0 \\   & & 2 \end{array}\right\rbrack  , b\left( t\right)  = \left\lbrack  \begin{matrix} 1 \\  0 \\  {e}^{2t} \end{matrix}\right\rbrack  , x\left( 0\right)  = \left\lbrack  \begin{matrix}  - 1 \\  1 \\  0 \end{matrix}\right\rbrack$

求 ${x}^{\prime }\left( t\right)  = A \cdot  x\left( t\right)  + b\left( t\right)$ 满足初始条件 $x\left( 0\right)$ 的特解

解: $\;{\mathrm{e}}^{\mathrm{t}\mathrm{A}} = \left\lbrack  \begin{array}{rrr} {\mathrm{e}}^{\mathrm{t}} & {\mathrm{{te}}}^{\mathrm{t}} & 0 \\  {\mathrm{e}}^{\mathrm{t}} & 0 & {\mathrm{e}}^{-\tau \mathrm{A}} \\   & {\mathrm{e}}^{2\mathrm{t}} & 1 \end{array}\right\rbrack$ , $\;{\mathrm{e}}^{-\tau \mathrm{A}}\mathrm{b}\left( \tau \right)  = \left\lbrack  \begin{matrix} {\mathrm{e}}^{-\tau } \\  0 \\  1 \end{matrix}\right\rbrack$ , ${\int }_{0}^{t}{\mathrm{e}}^{-{\tau A}}b\left( \tau \right) \mathrm{d}\tau  = \left\lbrack  \begin{matrix} 1 - {\mathrm{e}}^{-t} \\  0 \\  t \end{matrix}\right\rbrack$

$$
x\left( t\right)  = {e}^{tA} \cdot  \left\lbrack  {\left( \begin{matrix}  - 1 \\  1 \\  0 \end{matrix}\right)  + \left( \begin{matrix} 1 - {e}^{-t} \\  0 \\  t \end{matrix}\right) }\right\rbrack   = \left\lbrack  \begin{matrix} t{e}^{t} - 1 \\  {e}^{t} \\  t{e}^{2t} \end{matrix}\right\rbrack
$$

## 矩阵微分与最优化

最简单的最优化问题是求 $\mathrm{f}\left( \mathrm{x}\right)$ 的极大值和极小值

$$
\mathop{\min }\limits_{{x \in  R}}f\left( x\right)
$$

一般称为无约束的最优化问题

相对于 $\mathrm{n} \times  1$ 向量 $\mathrm{x}$ 的梯度算子记作 ${\nabla }_{\mathrm{x}}$

$$
{\nabla }_{\mathrm{x}} = {\left\lbrack  \frac{\partial }{\partial {\mathrm{x}}_{1}},\frac{\partial }{\partial {\mathrm{x}}_{2}},\cdots ,\frac{\partial }{\partial {\mathrm{x}}_{\mathrm{n}}}\right\rbrack  }^{\mathrm{T}} = \frac{\partial }{\partial \mathrm{x}}
$$

$\mathrm{n} \times  1$ 实向量 $\mathrm{x}$ 为变元的实标量函数的梯度

$$
{\nabla }_{x}f\left( x\right)  = {\left\lbrack  \frac{\partial f\left( x\right) }{\partial {x}_{1}},\frac{\partial f\left( x\right) }{\partial {x}_{2}},\cdots ,\frac{\partial f\left( x\right) }{\partial {x}_{n}}\right\rbrack  }^{T} = \frac{\partial f\left( x\right) }{\partial x}
$$

矩阵微分与最优化

实标量函数 $f\left( A\right)$ 为相对于实矩阵 $A = {\left\lbrack  {a}_{ij}\right\rbrack  }_{m \times  n}$ 的梯度

$$
\frac{\partial f\left( A\right) }{\partial A} = {\left\lbrack  \frac{\partial f\left( A\right) }{\partial {a}_{ij}}\right\rbrack  }_{m \times  n} = {\nabla }_{A}f\left( A\right)
$$

例:CDMA系统中，有K个用户，第k个用户的扩频波形向量为 ${\mathrm{s}}_{\mathrm{k}}\left( \mathrm{t}\right)$ 。 假定用户 $\mathrm{k}$ 的信号幅值为 ${\mathrm{A}}_{\mathrm{k}}$ ,在 $\mathrm{t}$ 时刻发送比特为 ${\mathrm{b}}_{\mathrm{k}}\left( {+1, - 1}\right)$ 在基站解扩后, 基站的接收信号向量为

$$
\mathrm{y} = \mathrm{{RAb}} + \mathrm{n}
$$

其中 $A = \operatorname{diag}\left( {{A}_{1},{A}_{2},\cdots ,{A}_{K}}\right) , b = {\left\lbrack  {b}_{1},{b}_{2},\cdots ,{b}_{K}\right\rbrack  }^{T}$

扩频相关矩阵 $R$ 的元素 ${r}_{ij} = {\int }_{0}^{T}{s}_{i}\left( t\right) {s}_{j}\left( t\right) {dt}$

设计一个多用户检测器 $M = \left\lbrack  {{m}_{1},{m}_{2},\cdots ,{m}_{K}}\right\rbrack$ ,使得

$$
\widehat{{b}_{k}} = \operatorname{sgn}\left( {{m}_{k}^{T}y}\right)
$$

将 $\mathrm{K}$ 个用户的检测器联合考虑,构造目标函数

$$
J\left( M\right)  = \mathrm{E}\left\lbrack  {\begin{Vmatrix}\mathbf{b} - \mathbf{M}\mathbf{y}\end{Vmatrix}}_{2}^{2}\right\rbrack
$$

使其最小化, 即可得到最优的盲多用户检测器M

利用矩阵迹的性质, 可得

$$
J\left( M\right)  = E\left\{  {{\left( b - My\right) }^{T}\left( {b - {My}}\right) }\right\}
$$

$$
= E\left\{  {{tr}\left\lbrack  {\left( {b - {My}}\right) {\left( b - My\right) }^{T}}\right\rbrack  }\right\}
$$

$$
= \operatorname{tr}\left\{  {E\left\lbrack  {\left( {b - {My}}\right) {\left( b - My\right) }^{T}}\right\rbrack  }\right\}
$$

$$
= \operatorname{tr}\{ \operatorname{cor}\left( {b - {My}}\right) \}
$$

其中 $\operatorname{cor}\left( {\mathrm{b} - \mathrm{{My}}}\right)  = \mathrm{E}\left\lbrack  {\left( {\mathrm{b} - \mathrm{{My}}}\right) {\left( \mathrm{b} - \mathrm{{My}}\right) }^{\mathrm{T}}}\right\rbrack$ 是自相关矩阵

在加性噪声与用户信号不相关时有

$$
\operatorname{cor}\left( {\mathrm{b} - \mathrm{{My}}}\right)  = \mathrm{I} + \mathrm{M}\left( {{\mathrm{{RA}}}^{2}\mathrm{R} + {\sigma }^{2}\mathrm{R}}\right) {\mathrm{M}}^{\mathrm{T}} - {\mathrm{{ARM}}}^{\mathrm{T}} - \mathrm{{MRA}}
$$

其中加性噪声的方差为 ${\sigma }^{2}$

于是目标函数可写作

$$
J\left( M\right)  = \operatorname{tr}\left\{  {\operatorname{cor}\left( {b - {My}}\right) }\right\}
$$

$$
= \operatorname{tr}\left( \mathbf{I}\right)  + \operatorname{tr}\left( {\mathbf{M}\left( {\mathbf{R}{\mathbf{A}}^{2}\mathbf{R} + {\sigma }^{2}\mathbf{I}}\right) {\mathbf{M}}^{\mathrm{T}}}\right)  - \operatorname{tr}\left( {\mathbf{A}\mathbf{R}{\mathbf{M}}^{\mathrm{T}}}\right)  - \operatorname{tr}\left( {\mathbf{M}\mathbf{R}\mathbf{A}}\right)
$$

利用迹函数的微分公式

$$
\frac{\partial \operatorname{tr}\left( {{\mathbf{M}}^{\mathrm{T}}\mathbf{B}}\right) }{\partial \mathbf{M}} = \frac{\partial \operatorname{tr}\left( {\mathbf{B}{\mathbf{M}}^{\mathrm{T}}}\right) }{\partial \mathbf{M}} = \mathbf{B}\;\frac{\partial \operatorname{tr}\left( {\mathbf{M}\mathbf{B}}\right) }{\partial \mathbf{M}} = \frac{\partial \operatorname{tr}\left( {\mathbf{B}\mathbf{M}}\right) }{\partial \mathbf{M}} = {\mathbf{B}}^{\mathrm{T}}
$$

$$
\frac{\partial \operatorname{tr}\left( {\mathrm{{MDM}}}^{\mathrm{T}}\right) }{\partial \mathrm{M}} = \mathrm{M}\left( {\mathrm{D} + {\mathrm{D}}^{\mathrm{T}}}\right)
$$

因为 $\mathrm{D} = {\mathrm{{RA}}}^{2}\mathrm{R} + {\sigma }^{2}\mathrm{I}$ 是对称矩阵,所以

$$
\frac{\partial \mathrm{J}\left( \mathrm{M}\right) }{\partial \mathrm{M}} = 2\mathrm{M}\left( {{\mathrm{{RA}}}^{2}\mathrm{R} + {\sigma }^{2}\mathrm{I}}\right)  - 2\mathrm{{AR}}
$$

令其为零, 即可得

$$
\mathrm{M}\left( {{\mathrm{{RA}}}^{2}\mathrm{R} + {\sigma }^{2}\mathrm{I}}\right)  = \mathrm{{AR}}
$$

如果R非奇异, 可得最优的多用户检测器为

$$
\mathrm{M} = \mathrm{A}{\left( {\mathrm{{RA}}}^{2} + {\sigma }^{2}\mathrm{I}\right) }^{-1}
$$

2025/11/8

## 作业

习题3.1

2

P100; 第4版:P142

习题3.3

3、4、5、6

P115~P115；第4版:P163

习题3.4

6、7、8、9

P115~P116；第4版:P170~P171

习题3.5

2、3、4

P125~P126；第4版:P177

2025/11/8