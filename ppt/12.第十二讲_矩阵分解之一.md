矩阵分析与应用

第十二讲 矩阵分解之一

# 信息与通信工程学院 吕旌阳

## 本讲主要内容

☐三角分解

Givens变换

HouseHolder变换

QR分解

[引入]在线性代数中应用Gauss消去法求解n元线性方程组

$$
\text{ Ax = b }
$$

其中: $A = {\left( {a}_{ij}\right) }_{n \times  n}, x = {\left( {x}_{1},{x}_{2},\cdots ,{x}_{n}\right) }^{T}, b = {\left( {b}_{1},{b}_{2},\cdots ,{b}_{n}\right) }^{T}$

Gauss消去法将系数矩阵化为上三角形矩阵, 或将增广矩阵化为上阶梯形矩阵, 而后回代求解。

$$
\left\lbrack  \begin{matrix} {a}_{11}^{\left( 1\right) } & {a}_{12}^{\left( 1\right) } & \cdots & {a}_{1n}^{\left( 1\right) } \\   & {a}_{22}^{\left( 2\right) } & \cdots & {a}_{2n}^{\left( 2\right) } \\   & &  \ddots  & \vdots \\   & & & {a}_{nn}^{\left( n\right) } \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} {X}_{1} \\  {X}_{2} \\  \vdots \\  {X}_{n} \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} {b}_{1}^{\left( 1\right) } \\  {b}_{2}^{\left( 2\right) } \\  \vdots \\  {b}_{n}^{\left( n\right) } \end{matrix}\right\rbrack
$$

$$
{\mathrm{X}}_{\mathrm{n}} = {\mathrm{b}}_{\mathrm{n}}^{\left( \mathrm{n}\right) }/{\mathrm{a}}_{\mathrm{{nn}}}^{\left( \mathrm{n}\right) }
$$

$$
{\mathrm{X}}_{\mathrm{i}} = \left( {{\mathrm{b}}_{\mathrm{i}}^{\left( \mathrm{i}\right) } - \mathop{\sum }\limits_{{\mathrm{j} = \mathrm{i} + 1}}^{\mathrm{n}}{\mathrm{a}}_{\mathrm{{ij}}}^{\left( \mathrm{i}\right) }{\mathrm{X}}_{\mathrm{j}}}\right) /{\mathrm{a}}_{\mathrm{{ii}}}^{\left( \mathrm{i}\right) }
$$

$$
\left( {i = n - 1,\ldots ,1}\right)
$$

定义 4.1 如果n 阶矩阵 $\mathrm{A}$ 能够分解为一个下三角矩阵 $\mathrm{L}$ 和一个上三角矩阵 U的乘积，则称其为三角分解或LU分解。如果方阵A可分解成 A=LDU，其中L为一个单位下三角矩阵，D为对角矩阵， $\mathbf{U}$ 为一个单位上三角矩阵, 则称 $A$ 可作LDU分解。

定理 4.1 矩阵 $A = {\left( {a}_{ij}\right) }_{n \times  n}$ 的分解式唯一的充要条件为 $A$ 的顺序主子式 ${\Delta }_{k} \neq  0 \; \mathrm{A} = \mathrm{{LDU}}$ ,其中 $\mathrm{L}$ 是单位下三角矩阵, $\mathrm{U}$ 是单位上三角矩阵,

D是对角矩阵, 并且

$$
D = \operatorname{diag}\left( {{d}_{1},{d}_{2},\cdots ,{d}_{n}}\right) ,{d}_{k} = \frac{{\Delta }_{k}}{{\Delta }_{k - 1}}, k = 1,2,\cdots , n\;\left( {{\Delta }_{0} = 1}\right)
$$

推论 设 $A$ 是 $n$ 阶非奇异矩阵， $A$ 有三角分解 $A = {LU}$ ，的充要条件

是 $\mathrm{A}$ 的顺序主子式 ${\Delta }_{k} \neq  0\;k = 1,2,\cdots , n$

分解原理:以 $\mathrm{n} = 4$ 为例

$$
{\Delta }_{1}\left( A\right)  = {a}_{11} : {a}_{11} \neq  0 \Rightarrow  {c}_{i1} = \frac{{a}_{i1}}{{a}_{11}}\;\left( {i = 2,3,4}\right)
$$

$$
{L}_{1} = \left\lbrack  \begin{array}{llll} 1 & & & \\  {c}_{21} & 1 & & \\  {c}_{31} & 0 & 1 & \\  {c}_{41} & 0 & 0 & 1 \end{array}\right\rbrack  ,{L}_{1}^{-1} = \left\lbrack  \begin{matrix} 1 & & & \\   - {c}_{21} & 1 & & \\   - {c}_{31} & 0 & 1 & \\   - {c}_{41} & 0 & 0 & 1 \end{matrix}\right\rbrack
$$

$$
{\mathrm{L}}_{1}^{-1}\mathrm{A} = \left\lbrack  \begin{matrix} {\mathrm{a}}_{11} & {\mathrm{a}}_{12} & {\mathrm{a}}_{13} & {\mathrm{a}}_{14} \\   & {\mathrm{a}}_{22}^{\left( 1\right) } & {\mathrm{a}}_{23}^{\left( 1\right) } & {\mathrm{a}}_{24}^{\left( 1\right) } \\   & {\mathrm{a}}_{32}^{\left( 1\right) } & {\mathrm{a}}_{33}^{\left( 1\right) } & {\mathrm{a}}_{34}^{\left( 1\right) } \\   & {\mathrm{a}}_{42}^{\left( 1\right) } & {\mathrm{a}}_{43}^{\left( 1\right) } & {\mathrm{a}}_{44}^{\left( 1\right) } \end{matrix}\right\rbrack   = {\mathrm{A}}^{\left( 1\right) }
$$

(2) ${\Delta }_{2}\left( A\right)  = {\Delta }_{2}\left( {A}^{\left( 1\right) }\right)  = {a}_{11}{a}_{22}^{\left( 1\right) } : \;{a}_{22}^{\left( 1\right) } \neq  0$

$$
\Rightarrow  {c}_{i2} = \frac{{a}_{i2}^{\left( 1\right) }}{{a}_{22}^{\left( 1\right) }}\;\left( {i = 3,4}\right)
$$

$$
{\mathrm{L}}_{2} = \left\lbrack  \begin{array}{llll} 1 & & & \\  0 & 1 & & \\  0 & {\mathrm{c}}_{32} & 1 & \\  0 & {\mathrm{c}}_{42} & 0 & 1 \end{array}\right\rbrack  ,{\mathrm{L}}_{2}^{-1} = \left\lbrack  \begin{array}{llll} 1 & & & \\  0 & 1 & & \\  0 &  - {\mathrm{c}}_{32} & 1 & \\  0 &  - {\mathrm{c}}_{42} & 0 & 1 \end{array}\right\rbrack
$$

$$
{\mathrm{L}}_{2}^{-1}{\mathrm{\;A}}^{\left( 1\right) } = \left\lbrack  \begin{array}{llll} {\mathrm{a}}_{11} & {\mathrm{a}}_{12} & {\mathrm{a}}_{13} & {\mathrm{a}}_{14} \\   & {\mathrm{a}}_{22}^{\left( 1\right) } & {\mathrm{a}}_{23}^{\left( 1\right) } & {\mathrm{a}}_{24}^{\left( 1\right) } \\   & & {\mathrm{a}}_{33}^{\left( 2\right) } & {\mathrm{a}}_{34}^{\left( 2\right) } \\   & & {\mathrm{a}}_{43}^{\left( 2\right) } & {\mathrm{a}}_{44}^{\left( 2\right) } \end{array}\right\rbrack
$$

$= {\mathrm{A}}^{\left( 2\right) }$

$$
\text{ (3) }{\Delta }_{3}\left( \mathrm{A}\right)  = {\Delta }_{3}\left( {\mathrm{\;A}}^{\left( 2\right) }\right)  = {\mathrm{a}}_{11}{\mathrm{a}}_{22}^{\left( 1\right) }{\mathrm{a}}_{33}^{\left( 2\right) } : {\mathrm{a}}_{33}^{\left( 2\right) } \neq  0
$$

$$
\Rightarrow  {\mathrm{c}}_{43} = \frac{{\mathrm{a}}_{43}^{\left( 2\right) }}{{\mathrm{a}}_{33}^{\left( 2\right) }}
$$

$$
{\mathrm{L}}_{3} = \left\lbrack  \begin{array}{llll} 1 & 0 & 1 & 0 \\  0 & 1 & 1 & 1 \\  0 & 0 & {\mathrm{c}}_{43} & 1 \end{array}\right\rbrack  ,{\mathrm{L}}_{3}^{-1} = \left\lbrack  \begin{array}{llll} 1 & 0 & 1 & 1 \\  0 & 1 & 1 & 1 \\  0 & 0 &  - {\mathrm{c}}_{43} & 1 \end{array}\right\rbrack
$$

$$
{\mathrm{L}}_{3}^{-1}{\mathrm{\;A}}^{\left( 2\right) } = \left\lbrack  \begin{array}{llll} {\mathrm{a}}_{11} & {\mathrm{a}}_{12} & {\mathrm{a}}_{13} & {\mathrm{a}}_{14} \\   & {\mathrm{a}}_{22}^{\left( 1\right) } & {\mathrm{a}}_{23}^{\left( 1\right) } & {\mathrm{a}}_{24}^{\left( 1\right) } \\   & & {\mathrm{a}}_{33}^{\left( 2\right) } & {\mathrm{a}}_{34}^{\left( 2\right) } \\   & & & {\mathrm{a}}_{44}^{\left( 3\right) } \end{array}\right\rbrack   = {\mathrm{A}}^{\left( 3\right) }
$$

即: ${L}_{3}^{-1}{L}_{2}^{-1}{L}_{1}^{-1}A = {A}^{\left( 3\right) } \Rightarrow  A = {L}_{1}{L}_{2}{L}_{3}{A}^{\left( 3\right) }$

令 $L = {L}_{1}{L}_{2}{L}_{3} = \left\lbrack  \begin{array}{llll} 1 & & & \\  {c}_{21} & 1 & & \\  {c}_{31} & {c}_{32} & 1 & \\  {c}_{41} & {c}_{42} & {c}_{43} & 1 \end{array}\right\rbrack$ 则 $A = L{A}^{\left( 3\right) }$

分解 ${A}^{\left( 3\right) } = \left\lbrack  \begin{array}{llll} {a}_{11} & & & \\   & {a}_{22}^{\left( 1\right) } & & \\   & & {a}_{33}^{\left( 2\right) } & \\   & & & {a}_{44}^{\left( 3\right) } \end{array}\right\rbrack  \left\lbrack  \begin{array}{llll} 1 &  * &  * &  * \\   & 1 &  * &  * \\   & & 1 &  * \\   & & & 1 \end{array}\right\rbrack   = {DU}$

则 $A = {LDU}$

二、紧凑格式算法: $\mathrm{A} = \mathrm{{LDU}} = \widetilde{\mathrm{L}}\mathrm{U}\;$ (Crout分解)

$$
L = \widetilde{L} = \left\lbrack  \begin{matrix} {l}_{11} & & & \\  {l}_{21} & {l}_{22} &  \ddots  & \\  \vdots & \vdots &  \ddots  & \\  {l}_{n1} & {l}_{n2} & \cdots & {l}_{nn} \end{matrix}\right\rbrack  , U = \left\lbrack  \begin{matrix} 1 & {u}_{12} & \cdots & {u}_{1n} \\   & 1 & \cdots & {u}_{2n} \\   & &  \ddots  & \vdots \\   & & & 1 \end{matrix}\right\rbrack
$$

二、紧凑格式算法: $\mathrm{A} = \mathrm{{LDU}} = \widetilde{\mathrm{L}}\mathrm{U}\;$ (Crout分解)

$$
\left\lbrack  \begin{matrix} {a}_{11} & {a}_{12} & \cdots & {a}_{1n} \\  {a}_{21} & {a}_{22} &  \ddots  & {a}_{2n} \\  \vdots & \vdots &  \ddots  & \vdots \\  {a}_{n1} & {a}_{n2} & \cdots & {a}_{nn} \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} {I}_{11} & & & \\  {I}_{21} & {I}_{22} &  \ddots  & \\  \vdots & \vdots &  \ddots  & \\  {I}_{n1} & {I}_{n2} & \cdots & {I}_{nn} \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} 1 & {u}_{12} & \cdots & {u}_{1n} \\   & 1 & \cdots & {u}_{2n} \\   & &  \ddots  & \vdots \\   & & & 1 \end{matrix}\right\rbrack
$$

$\underset{\left( {i,1}\right) \overline{L}}{\overline{\text{ 元 }}} : \;{a}_{i1} = {l}_{i1} \bullet  1\; \Rightarrow  {l}_{i1} = {a}_{i1}\;\left( {i = 1,\cdots , n}\right)$

$$
\left( {1, j}\right) \text{ 元: }{a}_{1j} = {l}_{11} \cdot  {u}_{1j}\; \Rightarrow  {u}_{1j} = \frac{{a}_{1j}}{{l}_{11}}\;\left( {j = 2,\cdots , n}\right)
$$

$\left( {i, k}\right) \overline{\mathrm{\text{ 元 }}} : \;{a}_{\mathrm{i}\mathrm{k}} = {l}_{\mathrm{i}1}\overset{ \bullet  }{{u}_{1\mathrm{k}}} + \cdots  + {l}_{\mathrm{i},\mathrm{k} - 1}\overset{ \bullet  }{{u}_{\mathrm{k} - 1,\mathrm{k}}} + {l}_{\mathrm{i}\mathrm{k}}\overset{ \bullet  }{1}\;\left( {\mathrm{i} \geq  \mathrm{k}}\right)$

$$
\Rightarrow  {l}_{\mathrm{i}\mathrm{k}} = {\mathrm{a}}_{\mathrm{i}\mathrm{k}} - \left( {{l}_{\mathrm{i}1} \bullet  {u}_{1\mathrm{k}} + \cdots  + {l}_{\mathrm{i},\mathrm{k} - 1} \bullet  {u}_{\mathrm{k} - 1,\mathrm{k}}}\right)
$$

$\left( {k, j}\right) \widehat{\text{ 元 }:}\;{a}_{kj} = {l}_{k\;1} \bullet  {u}_{1, j} + \cdots  + {l}_{k, k - 1} \bullet  {u}_{k - 1, j} + {l}_{kk} \bullet  {u}_{kj}\;\left( {\;j > k}\right)$

$$
\Rightarrow  {u}_{kj} = \frac{1}{{l}_{kk}}\left\lbrack  {{a}_{kj} - \left( {{l}_{k1} \bullet  {u}_{1j} + \cdots  + {l}_{k, k - 1} \bullet  {u}_{k - 1, j}}\right) }\right\rbrack
$$

计算框图:

$$
\begin{matrix} {l}_{11} & {u}_{12} & {u}_{13} & {u}_{14} & \cdots & \text{ 第1框 } \\  {l}_{21} & {l}_{22} & {u}_{23} & {u}_{24} & \cdots & \text{ 第2框 } \\  {l}_{31} & {l}_{32} & {l}_{33} & {u}_{34} & \cdots & \text{ 第3框 } \\  {l}_{41} & {l}_{42} & {l}_{43} & {l}_{44} & \cdots & \text{ 第4框 } \\  \vdots & \vdots & \vdots & \vdots & & \vdots  \end{matrix}
$$

$$
{\mathrm{l}}_{\mathrm{i}1} = {\mathrm{a}}_{\mathrm{i}1}\;\left( {\mathrm{i} = 1,\cdots ,\mathrm{n}}\right)
$$

$$
{\mathrm{u}}_{1\mathrm{j}} = \frac{{\mathrm{a}}_{1\mathrm{j}}}{{\mathrm{l}}_{11}}\;\left( {\mathrm{j} = 2,\cdots ,\mathrm{n}}\right)
$$

$$
{\mathrm{l}}_{\mathrm{{ik}}} = {\mathrm{a}}_{\mathrm{{ik}}} - \left( {{\mathrm{l}}_{\mathrm{i}1} \bullet  {\mathrm{u}}_{1\mathrm{k}} + \cdots  + {\mathrm{l}}_{\mathrm{i},\mathrm{k} - 1} \bullet  {\mathrm{u}}_{\mathrm{k} - 1,\mathrm{k}}}\right) \;(\mathrm{i} \geq  \mathrm{k}
$$

$$
{u}_{kj} = \frac{1}{{l}_{kk}}\left\lbrack  {{a}_{kj} - \left( {{l}_{k1} \cdot  {u}_{1j} + \cdots  + {l}_{k, k - 1} \cdot  {u}_{k - 1, j}}\right) }\right\rbrack  \;\left( {j \leq  k}\right)
$$

$$
A = \left\lbrack  \begin{array}{rrrr} 5 & 2 &  - 4 & 0 \\  2 & 1 &  - 2 & 1 \\   - 4 &  - 2 & 5 & 0 \\  0 & 1 & 0 & 2 \end{array}\right\rbrack  \;\text{ 计算框图: }\left\lbrack  \begin{array}{rrrr} 5 & 2/5 &  - 4/5 & 0 \\  2 & 1/5 &  - 2 & 5 \\   - 4 &  - 2/5 & 1 & 2 \\  0 & 1 & 2 &  - 7 \end{array}\right.
$$

$$
{\mathrm{l}}_{\mathrm{i}1} = {\mathrm{a}}_{\mathrm{i}1}\;\left( {\mathrm{i} = 1,\cdots ,\mathrm{n}}\right)
$$

$$
{\mathrm{u}}_{1\mathrm{j}} = \frac{{\mathrm{a}}_{1\mathrm{j}}}{{\mathrm{l}}_{11}}\;\left( {\mathrm{j} = 2,\cdots ,\mathrm{n}}\right)
$$

$$
{l}_{ik} = {a}_{ik} - \left( {{l}_{i1} \cdot  {u}_{1k} + \cdots  + {l}_{i, k - 1} \cdot  {u}_{k - 1, k}}\right) \;\left( {i \geq  k}\right)
$$

$$
{u}_{kj} = \frac{1}{{l}_{kk}}\left\lbrack  {{a}_{kj} - \left( {{l}_{k1} \cdot  {u}_{1j} + \cdots  + {l}_{k, k - 1} \cdot  {u}_{k - 1, j}}\right) }\right\rbrack  \;\left( {j \leq  k}\right)
$$

$$
A = \left\lbrack  \begin{array}{rrrr} 5 & 2 &  - 4 & 0 \\  2 & 1 &  - 2 & 1 \\   - 4 &  - 2 & 5 & 0 \\  0 & 1 & 0 & 2 \end{array}\right\rbrack
$$

$$
\left| \begin{array}{rrrr} 5 & 2/5 &  - 4/5 & 0 \\  2 & 1/5 &  - 2 & 5 \\   - 4 &  - 2/5 & 1 & 2 \\  0 & 1 & 2 &  - 7 \end{array}\right|
$$

$$
\widetilde{L} = \left\lbrack  \begin{array}{rrrr} 5 & 0 & 0 & 0 \\  2 & 1/5 & 0 & 0 \\   - 4 &  - 2/5 & 1 & 0 \\  0 & 1 & 2 &  - 7 \end{array}\right\rbrack   = \left\lbrack  \begin{array}{rrrr} 1 & & & \\  2/5 & 1 & & \\   - 4/5 &  - 2 & 1 & \\  0 & 5 & 2 & 1 \end{array}\right\rbrack  \left\lbrack  \begin{array}{llll} 5 & & & \\   & 1/5 & & \\   & & 1 & \\   & & &  - 7 \end{array}\right\rbrack
$$

$$
U = \left\lbrack  \begin{array}{rrrr} 1 & 2/5 &  - 4/5 & 0 \\  0 & 1 &  - 2 & 5 \\  0 & 0 & 1 & 2 \\  0 & 0 & 0 & 1 \end{array}\right\rbrack
$$

## QR分解

目的:将分解为正交矩阵与上三角矩阵之积.

约定:本节涉及的矩阵为实矩阵，向量为实向量，数为实数.

一、Givens矩阵

$$
{T}_{ij}\left( {c, s}\right) \overset{\Delta }{ = }\left\lbrack  \begin{matrix} I & & & & \\   & c & & s & \\   & & I & & \\   &  - s & & c & \\   & & & & I \end{matrix}\right\rbrack
$$

(i)

$$
{\mathrm{c}}^{2} + {\mathrm{s}}^{2} = 1
$$

(j)

性质:

(1) ${T}_{ij}^{T}{T}_{ij} = I,{\left\lbrack  {T}_{ij}\left( c, s\right) \right\rbrack  }^{-1} = {\left\lbrack  {T}_{ij}\left( c, s\right) \right\rbrack  }^{T} = {T}_{ij}\left( {c, - s}\right) ,\left| {T}_{ij}\right|  = 1$ (2) $x = \left\lbrack  \begin{matrix} {\xi }_{1} \\  \vdots \\  {\xi }_{n} \end{matrix}\right\rbrack  ,\;{T}_{ij}x = \left\lbrack  \begin{matrix} {\eta }_{1} \\  \vdots \\  {\eta }_{n} \end{matrix}\right\rbrack   \Rightarrow  \left\{  \begin{array}{l} {\eta }_{i} = c{\xi }_{i} + s{\xi }_{j} \\  {\eta }_{j} =  - s{\xi }_{i} + c{\xi }_{j} \\  {\eta }_{k} = {\xi }_{k}\left( {k \neq  i, j}\right)  \end{array}\right.$ 若 ${\xi }_{i}^{2} + {\xi }_{j}^{2} \neq  0,,$ 取 $c = \frac{{\xi }_{i}}{\sqrt{{\xi }_{i}^{2} + {\xi }_{j}^{2}}}, s = \frac{{\xi }_{j}}{\sqrt{{\xi }_{i}^{2} + {\xi }_{j}^{2}}}$ 则 ${\mathbf{\eta }}_{\mathrm{i}} = \sqrt{{\xi }_{\mathrm{i}}^{2} + {\xi }_{\mathrm{j}}^{2}} > 0,{\mathbf{\eta }}_{\mathrm{j}} = 0$

定理3: $x \neq  0 \Rightarrow  \exists$ 有限个 $G$ -矩阵之积 $T,{st}.{Tx} = \left| x\right| {e}_{1}$

推论: 设非零列向量 $x \in  {R}^{n}$ 及单位列向量 $z \in  {R}^{n}$ ,则存在有限个 Givens矩阵之积, 记作T, 使得

$$
T\mathbf{x} = \left| \mathbf{x}\right| \mathbf{z}
$$

例: $\;x = \left\lbrack  \begin{array}{l} 3 \\  4 \\  5 \end{array}\right\rbrack  \;$ 求 $G$ -矩阵之积 $T$ ,使得 ${Tx} = \left| x\right| {e}_{1}$

解: ${T}_{12}\left( {c, s}\right)$ 中, $c = \frac{3}{5}, s = \frac{4}{5} \cdot  {T}_{12}x = \left\lbrack  \begin{array}{l} 5 \\  0 \\  5 \end{array}\right\rbrack \; {T}_{13}\left( {c, s}\right)$ 中, $c = \frac{1}{\sqrt{2}}, s = \frac{1}{\sqrt{2}}.\;{T}_{13}\left( {{T}_{12}x}\right)  = \left| \begin{matrix} 5\sqrt{2} \\  0 \\  0 \end{matrix}\right|  = \left| x\right| {e}_{1}$

$$
T = {T}_{13}{T}_{12} = \frac{1}{\sqrt{2}}\left\lbrack  \begin{matrix} 1 & 0 & 1 \\  0 & \sqrt{2} & 0 \\   - 1 & 0 & 1 \end{matrix}\right\rbrack   \cdot  \frac{1}{5}\left\lbrack  \begin{matrix} 3 & 4 & 0 \\   - 4 & 3 & 0 \\  0 & 0 & 5 \end{matrix}\right\rbrack   = \frac{1}{5\sqrt{2}}\left\lbrack  \begin{array}{rrr} 3 & 4 & 5 \\   - 4\sqrt{2} & 3\sqrt{2} & 0 \\   - 3 &  - 4 & 5 \end{array}\right\rbrack
$$

$$
\mathrm{{Tx}} = 5\sqrt{2}{\mathrm{e}}_{1}
$$

## Householder矩阵

在平面 ${\mathrm{R}}^{2}$ 中,将向量 $\mathrm{x}$ 映射为关于 ${\mathrm{e}}_{1}$ 对称的向量 $\mathrm{y}$ 的变换,称为是关于 ${\mathrm{e}}_{1}$ 轴的镜像(反射)变换

设 $x = \left\lbrack  \begin{array}{l} {\xi }_{1} \\  {\xi }_{2} \end{array}\right\rbrack$ ,有

$$
\mathrm{y} = \left\lbrack  \begin{matrix} {\xi }_{1} \\   - {\xi }_{2} \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} 1 & 0 \\  0 &  - 1 \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} {\xi }_{1} \\  {\xi }_{2} \end{matrix}\right\rbrack   = \left( {\mathrm{I} - 2{\mathrm{e}}_{2}{\mathrm{e}}_{2}^{\mathrm{T}}}\right) \mathrm{x} = \mathrm{{Hx}}
$$

其中, ${\mathrm{e}}_{2} = {\left\lbrack  \begin{array}{ll} 0 & 1 \end{array}\right\rbrack  }^{\mathrm{T}},\mathrm{H}$ 是正交矩阵,且 $\left| \mathrm{H}\right|  =  - 1$

## Householder矩阵

将向量 x 映射为关于 “与单位向量u正交的直线” 对称的向量 $y$ 的变换

$$
x - y = {2u}\left( {{u}^{T}x}\right)
$$

$$
y = x - {2u}\left( {{u}^{T}x}\right)  = \left( {I - {2u}{u}^{T}}\right) x = {Hx}
$$

显然, $\mathrm{H}$ 是正交矩阵

$$
{\mathrm{H}}^{\mathrm{T}}\mathrm{H} = {\left( \mathrm{I} - 2{\mathrm{{uu}}}^{\mathrm{T}}\right) }^{\mathrm{T}}\left( {\mathrm{I} - 2{\mathrm{{uu}}}^{\mathrm{T}}}\right)
$$

$$
= \left( {\mathrm{I} - 2{\mathrm{{uu}}}^{\mathrm{T}}}\right) \left( {\mathrm{I} - 2{\mathrm{{uu}}}^{\mathrm{T}}}\right)
$$

$$
= \mathrm{I} + 4{\mathrm{{uu}}}^{\mathrm{T}}{\mathrm{{uu}}}^{\mathrm{T}} - 4{\mathrm{{uu}}}^{\mathrm{T}}
$$

$$
= \mathrm{I} + 4{\mathrm{{uu}}}^{\mathrm{T}} - 4{\mathrm{{uu}}}^{\mathrm{T}} = \mathrm{I}
$$

## Householder矩阵

将向量 x 映射为关于 “与单位向量u正交的直线” 对称的向量 $y$ 的变换

$$
x - y = {2u}\left( {{u}^{T}x}\right)
$$

$$
y = x - {2u}\left( {{u}^{T}x}\right)  = \left( {I - {2u}{u}^{T}}\right) x = {Hx}
$$

显然, H是正交矩阵

定义: 设单位列向量 $u \in  {R}^{n}$ ,称 $H = I - {2u}{u}^{T}$ 为Householder矩阵

(初等反射矩阵), 由H矩阵确定的线性变换称为Householder变换。

## Householder矩阵

${\mathrm{H}}_{\mathrm{u}} = {\mathrm{I}}_{\mathrm{n}} - 2{\mathrm{{uu}}}^{\mathrm{T}}$ ( $\mathrm{u} \in  {\mathrm{R}}^{\mathrm{n}}$ 是单位列向量)

(1) $\mathrm{H} = {\mathrm{H}}^{\mathrm{T}}$ 对称 (2) ${\mathrm{H}}^{\mathrm{T}}\mathrm{H} = \mathrm{I}$ 正交

(3) ${\mathrm{H}}^{2} = \mathrm{I}\;$ 对合 (4) ${\mathrm{H}}^{-1} = \mathrm{H}$ 自逆

(5) $\det \mathrm{H} =  - 1$ 自逆

验证(5):

$$
\left\lbrack  \begin{matrix} I & 0 \\   - {u}^{T} & 1 \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} I & {2u} \\  {0}^{T} & 1 \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} I - {2u}{u}^{T} & 0 \\  {u}^{T} & 1 \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} I & 0 \\   - {u}^{T} & 1 \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} I & {2u} \\  {u}^{T} & 1 \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} I & {2u} \\  {0}^{T} &  - 1 \end{matrix}\right\rbrack
$$

$$
\left| \begin{matrix} I - {2u}{u}^{T} & 0 \\  {u}^{T} & 1 \end{matrix}\right|  = \left| \begin{matrix} I & {2u} \\  {0}^{T} &  - 1 \end{matrix}\right|  =  - 1
$$

定理 4: ${R}^{n}$ 中 $\left( {n > 1}\right) ,\forall x \neq  0,\forall$ 单位列向量 $z \Rightarrow  \exists {H}_{u}$ , st ${H}_{u}x = \left| x\right| z$ 证明: $\left( 1\right) x = \left| x\right| z : n > 1$ 时,取单位向量 $u$ 使得 $u \bot  x$ ,

于是 ${H}_{u} = I - {2u}{u}^{T} : {H}_{u}x = {Ix} - {2u}{u}^{T}x = x = \left| x\right| z$

(2) $x \neq  \left| x\right| z :$ 取 $u = \frac{x - \left| x\right| z}{\left| x - \left| x\right| z\right| }$ ,有 $\left( {x - \left| x\right| z, x}\right)  = {\left| x\right| }^{2} - \left| x\right| \left( {z, x}\right) \; {\left| x - \left| x\right| z\right| }^{2} = \left( {x - \left| x\right| z, x - \left| x\right| z}\right)  = 2{\left| x\right| }^{2} - 2\left| x\right| \left( {z, x}\right) \; {H}_{u}x = \left\lbrack  {I - 2\frac{\left( {x - \left| x\right| z}\right) {\left( x - \left| x\right| z\right) }^{T}}{{\left| x - \left| x\right| z\right| }^{2}}}\right\rbrack  x\; = x - \frac{2\left( {x - \left| x\right| z, x}\right) }{{\left| x - \left| x\right| z\right| }^{2}}\left( {x - \left| x\right| z}\right) \; = x - 1 \times  \left( {x - \left| x\right| z}\right)  = \left| x\right| z$

例 2: $x = \left\lbrack  \begin{array}{l} 1 \\  2 \\  2 \end{array}\right\rbrack$ ,求 $H$ -矩阵 $H$ 使得 ${Hx} = \left| x\right| {e}_{1}$

解: $\left| x\right|  = 3, x - \left| x\right| {e}_{1} = \left\lbrack  \begin{matrix}  - 2 \\  2 \\  2 \end{matrix}\right\rbrack  ,\;u = \frac{1}{\sqrt{3}}\left\lbrack  \begin{matrix}  - 1 \\  1 \\  1 \end{matrix}\right\rbrack$

$$
H = I - \frac{2}{3}\left\lbrack  \begin{matrix}  - 1 \\  1 \\  1 \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix}  - 1 & 1 & 1 \end{matrix}\right\rbrack   = \frac{1}{3}\left\lbrack  \begin{matrix} 1 & 2 & 2 \\  2 & 1 &  - 2 \\  2 &  - 2 & 1 \end{matrix}\right\rbrack
$$

Hx $= 3{\mathrm{e}}_{1}$

## G矩阵与H-矩阵的关系

定理 5: G-矩阵 ${T}_{ij}\left( {c, s}\right)  \Rightarrow  \exists H$ -矩阵 ${H}_{u}$ 与 ${H}_{v},{st}{T}_{ij} = {H}_{u}{H}_{v}$ 证明: ${c}^{2} + {s}^{2} = 1 \Rightarrow$ 取 $\theta  = \arctan \frac{s}{c}$ ,则 $\cos \theta  = c,\sin \theta  = s$

$$
{T}_{ij}\left( {c, s}\right)  = \left\lbrack  \begin{array}{llll} I & & & \\   & \cos \theta & & \sin \theta \\   &  - \sin \theta & \cos \theta & \\   & & & I \end{array}\right\rbrack  \left( \begin{array}{l} i \\  j \end{array}\right)
$$

$$
v = {\left\lbrack  \begin{array}{lllllllllll} 0 & \cdots & 0 & \sin \frac{\theta }{4} & 0 & \cdots & 0 & \cos \frac{\theta }{4} & 0 & \cdots & 0 \end{array}\right\rbrack  }^{T}
$$

$$
{H}_{v} = \left\lbrack  \begin{array}{llll} I & & & \\   & I & & \\   & & I & \\   & & & I \end{array}\right\rbrack   - 2\left\lbrack  \begin{array}{llll} 0 & & & \\   & {\sin }^{2}\frac{\theta }{4} & \sin \frac{\theta }{4}\cos \frac{\theta }{4} & \\   & \sin \frac{\theta }{4}\cos \frac{\theta }{4} & {\cos }^{2}\frac{\theta }{4} & \\   & & & 0 \end{array}\right\rbrack
$$

$$
= \left\lbrack  \begin{matrix} \mathrm{I} & & & \\   & \cos \frac{\theta }{2} &  - \sin \frac{\theta }{2} & \\   & \mathrm{I} & & \\   - \sin \frac{\theta }{2} &  - \cos \frac{\theta }{2} & &  \end{matrix}\right\rbrack
$$

$$
u = {\left\lbrack  \begin{array}{lllllllllll} 0 & \cdots & 0 & \sin \frac{3\theta }{4} & 0 & \cdots & 0 & \cos \frac{3\theta }{4} & 0 & \cdots & 0 \end{array}\right\rbrack  }^{T}
$$

$$
{H}_{u} = \left\lbrack  \begin{matrix} I & & & \\   & \cos \frac{3\theta }{2} &  - \sin \frac{3\theta }{2} & \\   &  - \sin \frac{3\theta }{2} &  - \cos \frac{3\theta }{2} & \\   & & & I \end{matrix}\right\rbrack  ,
$$

$$
{\mathrm{T}}_{\mathrm{{ij}}}\left( {\mathrm{c},\mathrm{s}}\right)  = {\mathrm{H}}_{\mathrm{u}}{\mathrm{H}}_{\mathrm{v}}
$$

#

[注] H-矩阵不能由若干个G矩阵的乘积来表示。

因为 $\det H =  - 1$ ,而 $\det G = 1$

例3: G-矩阵 ${T}_{ij}\left( {0,1}\right)  = \left\lbrack  \begin{matrix} 0 & 1 \\   - 1 & 0 \end{matrix}\right\rbrack$ 中, $c = 0, s = 1 \Rightarrow  \theta  = \pi /2$

${\mathrm{H}}_{\mathrm{u}} = \frac{1}{\sqrt{2}}\left\lbrack  \begin{array}{rr}  - 1 &  - 1 \\   - 1 & 1 \end{array}\right\rbrack  ,{\mathrm{H}}_{\mathrm{v}} = \frac{1}{\sqrt{2}}\left\lbrack  \begin{array}{rr} 1 &  - 1 \\   - 1 &  - 1 \end{array}\right\rbrack$

$$
\Rightarrow  {\mathrm{H}}_{\mathrm{u}}{\mathrm{H}}_{\mathrm{v}} = \left\lbrack  \begin{matrix} 0 & 1 \\   - 1 & 0 \end{matrix}\right\rbrack
$$

## 四、 QR 分解

1. Schmidt正交化方法

定理6: ${A}_{nxn}$ 可逆 $\Rightarrow  \exists$ 正交矩阵Q，可逆上三角矩阵R，使得A=QR。

证明: $A = \left( {{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)$ 可逆 $\Rightarrow  {a}_{1},{a}_{2},\cdots ,{a}_{n}$ 线性无关,正交化后可得:

$$
\left\{  \begin{array}{l} {b}_{1} = {a}_{1} \\  {b}_{2} = {a}_{2} - {k}_{21}{b}_{1} \\  {b}_{n} = {a}_{n} - {k}_{n, n - 1}{b}_{n - 1} - \cdots  - {k}_{n1}{b}_{1} \end{array}\right.
$$

$$
\left\{  \begin{array}{l} {a}_{1} = {b}_{1} \\  {a}_{2} = {k}_{21}{b}_{1} + {b}_{2} \\  \cdots \cdots \\  {a}_{n} = {k}_{n1}{b}_{1} + \cdots  + {k}_{n, n - 1}{b}_{n - 1} + {b}_{n} \end{array}\right.
$$

$$
\left( {{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)  = \left( {{b}_{1},{b}_{2},\cdots ,{b}_{n}}\right) K
$$

$$
= \left( {{q}_{1},{q}_{2},\cdots ,{q}_{n}}\right) \left\lbrack  {\begin{array}{l} \left| {b}_{1}\right| \\   \\   \\   \\  \end{array}\left| {b}_{2}\right| \begin{array}{lll} {b}_{1} & \cdots & {b}_{n1} \\   &  \ddots  & \vdots \\   & & {b}_{n} \end{array}}\right\rbrack  \left\lbrack  \begin{matrix} 1 & {k}_{21} & \cdots & {k}_{n1} \\   & 1 & \cdots & {k}_{n2} \\   & &  \ddots  & \vdots \\   & & & 1 \end{matrix}\right\rbrack
$$

$$
Q = \left( {{q}_{1},{q}_{2},\cdots ,{q}_{n}}\right) , R = \left\lbrack  {\left| \begin{array}{lll} \left| {b}_{1}\right| & & \\   & \left| {b}_{2}\right| & \\   & &  \ddots   \end{array}\right| \left| \begin{array}{llll} 1 & {k}_{21} & \cdots & {k}_{n1} \\   & 1 & \cdots & {k}_{n2} \\   & &  \ddots  & \vdots \\   & & & 1 \end{array}\right| }\right\rbrack
$$

则 $A = {QR}$ ,其中 ${q}_{i} = \frac{{b}_{i}}{\left| {b}_{i}\right| }\;\left( {i = 1,2,\cdots , n}\right)$

例 4: 求 $A = \left\lbrack  \begin{array}{lll} 1 & 2 & 2 \\  2 & 1 & 2 \\  1 & 2 & 1 \end{array}\right\rbrack$ 的QR分解。

解: ${b}_{1} = {a}_{1} = \left\lbrack  \begin{array}{l} 1 \\  2 \\  1 \end{array}\right\rbrack  ,{b}_{2} = {a}_{2} - 1 \times  {b}_{1} = \left\lbrack  \begin{matrix} 1 \\   - 1 \\  1 \end{matrix}\right\rbrack  ,{b}_{3} = {a}_{3} - \frac{1}{3}{b}_{2} - \frac{7}{6}{b}_{1} = \left\lbrack  \begin{matrix} 1/2 \\  0 \\   - 1/2 \end{matrix}\right\rbrack$

$$
Q = \left\lbrack  \begin{matrix} \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{3}} & \frac{1}{\sqrt{2}} \\  \frac{2}{\sqrt{6}} &  - \frac{1}{\sqrt{3}} & 0 \\  \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{3}} &  - \frac{1}{\sqrt{2}} \end{matrix}\right\rbrack  \;R = \left\lbrack  \begin{matrix} \sqrt{6} & & \\   & \sqrt{3} & \\   & & \frac{1}{\sqrt{2}} \end{matrix}\right\rbrack  \left\lbrack  \begin{matrix} 1 & 1 & \frac{7}{6} \\   & 1 & \frac{1}{3} \\   & & 1 \end{matrix}\right\rbrack   = \left\lbrack  \begin{matrix} \sqrt{6} & \sqrt{6} & \frac{7}{\sqrt{6}} \\   & \sqrt{\frac{3}{\sqrt{3}}} & \\   & & \sqrt{\frac{3}{3}} \\   & & \\   & & \overline{1} \end{matrix}\right\rbrack
$$

定理 7: ${A}_{m \times  n}$ 列满秩 $\Rightarrow  \exists$ 矩阵 ${Q}_{m \times  n}$ 满足 ${Q}^{H}Q = I$ , 可逆上三角矩阵 ${R}_{n \times  n}$ ,使得 $A = {QR}$ 。

证明: 同定理6